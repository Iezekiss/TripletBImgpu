metadata:
  createdAt: 2025-11-19T21:17:04.007Z
  modifiedAt: 2025-11-20T08:59:02.765Z
project:
  id: bf6444c3-7e28-4718-a4cc-15d838d50389
  name: Cosmetics Research
  integrations:
    - id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
      name: Iezekiss
      type: big-query
  notebooks:
    - blocks:
        - blockGroup: a72435ac3ad149bbb105736c456754c9
          content: выведи первые столбцы на sql
          id: c9cbb28ccdd94aec8f1cc48c268391f8
          metadata:
            color: purple
          sortingKey: m
          type: text-cell-callout
        - blockGroup: 46b7178326cb4ed3b955af059e6a38ea
          content: |-
            SELECT id, brand, name, price, price_sign
            FROM `makeup_dataset`.`makeup`
            LIMIT 5
          executionCount: 19
          id: 6d8d276731d7477cad73a9e8522e07fd
          metadata:
            execution_start: 1763590173745
            execution_millis: 26787
            sql_integration_id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
            execution_context_id: 66d6a14e-1ed3-4385-9906-1b9addf09387
            deepnote_variable_name: makeup_data_preview
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 1176
                  compiled_query: |-
                    SELECT id, brand, name, price, price_sign
                    FROM `makeup_dataset`.`makeup`
                    LIMIT 5
                    /* {"app":"deepnote","submitted_by":"user","user_email":"darja.kuz2011@gmail.com","workspace_id":"5d927472-4f07-433e-9737-70a3fdd0c4d7","project_id":"bf6444c3-7e28-4718-a4cc-15d838d50389","notebook_id":"8bd7ecef2a68464496b2d68a96921f61","project_url":"https://deepnote.com/project/bf6444c3-7e28-4718-a4cc-15d838d50389"} */
                  variable_type: dataframe
                  integration_id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
              metadata: {}
              output_type: display_data
            - output_type: execute_result
              execution_count: 19
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 5
                  columns:
                    - name: id
                      dtype: int64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "1044"
                        max: "1048"
                        histogram:
                          - bin_start: 1044
                            bin_end: 1044.4
                            count: 1
                          - bin_start: 1044.4
                            bin_end: 1044.8
                            count: 0
                          - bin_start: 1044.8
                            bin_end: 1045.2
                            count: 1
                          - bin_start: 1045.2
                            bin_end: 1045.6
                            count: 0
                          - bin_start: 1045.6
                            bin_end: 1046
                            count: 0
                          - bin_start: 1046
                            bin_end: 1046.4
                            count: 1
                          - bin_start: 1046.4
                            bin_end: 1046.8
                            count: 0
                          - bin_start: 1046.8
                            bin_end: 1047.2
                            count: 1
                          - bin_start: 1047.2
                            bin_end: 1047.6
                            count: 0
                          - bin_start: 1047.6
                            bin_end: 1048
                            count: 1
                        categories: null
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 2
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: colourpop
                            count: 4
                          - name: boosh
                            count: 1
                    - name: name
                      dtype: object
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Lippie Pencil
                            count: 1
                          - name: Blotted Lip
                            count: 1
                          - name: 3 others
                            count: 3
                    - name: price
                      dtype: float64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "5.0"
                        max: "26.0"
                        histogram:
                          - bin_start: 5
                            bin_end: 7.1
                            count: 3
                          - bin_start: 7.1
                            bin_end: 9.2
                            count: 0
                          - bin_start: 9.2
                            bin_end: 11.3
                            count: 0
                          - bin_start: 11.3
                            bin_end: 13.4
                            count: 1
                          - bin_start: 13.4
                            bin_end: 15.5
                            count: 0
                          - bin_start: 15.5
                            bin_end: 17.6
                            count: 0
                          - bin_start: 17.6
                            bin_end: 19.700000000000003
                            count: 0
                          - bin_start: 19.700000000000003
                            bin_end: 21.8
                            count: 0
                          - bin_start: 21.8
                            bin_end: 23.900000000000002
                            count: 0
                          - bin_start: 23.900000000000002
                            bin_end: 26
                            count: 1
                        categories: null
                    - name: price_sign
                      dtype: object
                      stats:
                        unique_count: 1
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: $
                            count: 5
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - id: 1048
                      brand: colourpop
                      name: Lippie Pencil
                      price: 5
                      price_sign: $
                      _deepnote_index_column: 0
                    - id: 1047
                      brand: colourpop
                      name: Blotted Lip
                      price: 5.5
                      price_sign: $
                      _deepnote_index_column: 1
                    - id: 1046
                      brand: colourpop
                      name: Lippie Stix
                      price: 5.5
                      price_sign: $
                      _deepnote_index_column: 2
                    - id: 1045
                      brand: colourpop
                      name: No Filter Foundation
                      price: 12
                      price_sign: $
                      _deepnote_index_column: 3
                    - id: 1044
                      brand: boosh
                      name: Lipstick
                      price: 26
                      price_sign: $
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                       id      brand                  name  price price_sign
                  0  1048  colourpop         Lippie Pencil    5.0          $
                  1  1047  colourpop           Blotted Lip    5.5          $
                  2  1046  colourpop           Lippie Stix    5.5          $
                  3  1045  colourpop  No Filter Foundation   12.0          $
                  4  1044      boosh              Lipstick   26.0          $
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>id</th>
                        <th>brand</th>
                        <th>name</th>
                        <th>price</th>
                        <th>price_sign</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>1048</td>
                        <td>colourpop</td>
                        <td>Lippie Pencil</td>
                        <td>5.0</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>1047</td>
                        <td>colourpop</td>
                        <td>Blotted Lip</td>
                        <td>5.5</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>1046</td>
                        <td>colourpop</td>
                        <td>Lippie Stix</td>
                        <td>5.5</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>1045</td>
                        <td>colourpop</td>
                        <td>No Filter Foundation</td>
                        <td>12.0</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>1044</td>
                        <td>boosh</td>
                        <td>Lipstick</td>
                        <td>26.0</td>
                        <td>$</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: "{}"
          sortingKey: s
          type: sql
        - blockGroup: 067131116b0e4623925966d4c4437b7c
          content: "Here are the first few columns from the makeup data: id, brand, name,
            price, and price_sign."
          id: c7df05e5889d4e429dc9d27fe63cdee4
          metadata: {}
          sortingKey: v
          type: text-cell-p
        - blockGroup: 67803430d7ee4d8ebd3aeb0bcefa130f
          content: |
            SELECT 
              brand,
              SUM(CAST(price AS FLOAT64)) AS total_price
            FROM `cosmeticres.makeup_dataset.makeup`
            GROUP BY brand
            ORDER BY total_price DESC
          executionCount: 31
          id: 487e90a2cff84f92931bd60f67a00958
          metadata:
            execution_start: 1763590486855
            execution_millis: 749
            sql_integration_id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
            execution_context_id: 66d6a14e-1ed3-4385-9906-1b9addf09387
            deepnote_variable_name: df_2
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 4412
                  compiled_query: |-
                    SELECT 
                      brand,
                      SUM(CAST(price AS FLOAT64)) AS total_price
                    FROM `cosmeticres.makeup_dataset.makeup`
                    GROUP BY brand
                    ORDER BY total_price DESC
                    /* {"app":"deepnote","submitted_by":"user","user_email":"darja.kuz2011@gmail.com","workspace_id":"5d927472-4f07-433e-9737-70a3fdd0c4d7","project_id":"bf6444c3-7e28-4718-a4cc-15d838d50389","notebook_id":"8bd7ecef2a68464496b2d68a96921f61","project_url":"https://deepnote.com/project/bf6444c3-7e28-4718-a4cc-15d838d50389"} */
                  variable_type: dataframe
                  integration_id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
              metadata: {}
              output_type: display_data
            - output_type: execute_result
              execution_count: 31
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 2
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 57
                        nan_count: 1
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: clinique
                            count: 1
                          - name: 56 others
                            count: 56
                          - name: Missing
                            count: 1
                    - name: total_price
                      dtype: float64
                      stats:
                        unique_count: 46
                        nan_count: 1
                        min: "0.0"
                        max: "2094.3500000000004"
                        histogram:
                          - bin_start: 0
                            bin_end: 209.43500000000003
                            count: 41
                          - bin_start: 209.43500000000003
                            bin_end: 418.87000000000006
                            count: 6
                          - bin_start: 418.87000000000006
                            bin_end: 628.3050000000001
                            count: 3
                          - bin_start: 628.3050000000001
                            bin_end: 837.7400000000001
                            count: 2
                          - bin_start: 837.7400000000001
                            bin_end: 1047.1750000000002
                            count: 0
                          - bin_start: 1047.1750000000002
                            bin_end: 1256.6100000000001
                            count: 1
                          - bin_start: 1256.6100000000001
                            bin_end: 1466.0450000000003
                            count: 2
                          - bin_start: 1466.0450000000003
                            bin_end: 1675.4800000000002
                            count: 0
                          - bin_start: 1675.4800000000002
                            bin_end: 1884.9150000000002
                            count: 0
                          - bin_start: 1884.9150000000002
                            bin_end: 2094.3500000000004
                            count: 2
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 58
                  preview_row_count: 58
                  rows:
                    - brand: clinique
                      total_price: 2094.3500000000004
                      _deepnote_index_column: 0
                    - brand: dior
                      total_price: 2024.5
                      _deepnote_index_column: 1
                    - brand: nyx
                      total_price: 1380.5800000000002
                      _deepnote_index_column: 2
                    - brand: smashbox
                      total_price: 1373
                      _deepnote_index_column: 3
                    - brand: benefit
                      total_price: 1252
                      _deepnote_index_column: 4
                    - brand: physicians formula
                      total_price: 740.1699999999997
                      _deepnote_index_column: 5
                    - brand: l'oreal
                      total_price: 638.1100000000002
                      _deepnote_index_column: 6
                    - brand: maybelline
                      total_price: 601.46
                      _deepnote_index_column: 7
                    - brand: cargo cosmetics
                      total_price: 585
                      _deepnote_index_column: 8
                    - brand: covergirl
                      total_price: 522.9600000000003
                      _deepnote_index_column: 9
                  type: dataframe
                text/plain: |2-
                                         brand  total_price
                  0                   clinique      2094.35
                  1                       dior      2024.50
                  2                        nyx      1380.58
                  3                   smashbox      1373.00
                  4                    benefit      1252.00
                  5         physicians formula       740.17
                  6                    l'oreal       638.11
                  7                 maybelline       601.46
                  8            cargo cosmetics       585.00
                  9                  covergirl       522.96
                  10              dr. hauschka       407.00
                  11                    revlon       391.31
                  12                  pacifica       330.96
                  13                      None       252.88
                  14                pure anada       227.99
                  15                  marcelle       218.85
                  16            mineral fusion       203.00
                  17                     stila       184.99
                  18                    e.l.f.       182.73
                  19                     almay       177.26
                  20                  glossier       150.00
                  21                     sante       132.54
                  22                  anna sui       132.00
                  23                    milani       117.87
                  24                     fenty       116.00
                  25                 annabelle       107.86
                  26                   suncoat        96.04
                  27                   mistura        56.49
                  28                wet n wild        51.68
                  29                     zorah        51.00
                  30             butter london        50.96
                  31                      moov        44.97
                  32                      orly        42.98
                  33                     essie        40.00
                  34                 colourpop        28.00
                  35                     boosh        26.00
                  36                    dalish        22.00
                  37               burt's bees        19.98
                  38                    deciem        13.60
                  39               piggy paint        11.99
                  40                      alva         9.95
                  41                      misa         9.39
                  42               china glaze         8.00
                  43             salon perfect         6.99
                  44            sinful colours         2.99
                  45                 c'est moi         0.00
                  46  coastal classic creation         0.00
                  47              green people         0.00
                  48       lotus cosmetics usa         0.00
                  49     maia's mineral galaxy         0.00
                  50                marienatie         0.00
                  51                     nudus         0.00
                  52       penny lane organics         0.00
                  53           rejuva minerals         0.00
                  54    sally b's skin yummies         0.00
                  55                w3llpeople         0.00
                  56      zorah biocosmetiques         0.00
                  57                      iman          NaN
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>total_price</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>clinique</td>
                        <td>2094.35</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>dior</td>
                        <td>2024.50</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>nyx</td>
                        <td>1380.58</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>smashbox</td>
                        <td>1373.00</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>benefit</td>
                        <td>1252.00</td>
                      </tr>
                      <tr>
                        <th>5</th>
                        <td>physicians formula</td>
                        <td>740.17</td>
                      </tr>
                      <tr>
                        <th>6</th>
                        <td>l'oreal</td>
                        <td>638.11</td>
                      </tr>
                      <tr>
                        <th>7</th>
                        <td>maybelline</td>
                        <td>601.46</td>
                      </tr>
                      <tr>
                        <th>8</th>
                        <td>cargo cosmetics</td>
                        <td>585.00</td>
                      </tr>
                      <tr>
                        <th>9</th>
                        <td>covergirl</td>
                        <td>522.96</td>
                      </tr>
                      <tr>
                        <th>10</th>
                        <td>dr. hauschka</td>
                        <td>407.00</td>
                      </tr>
                      <tr>
                        <th>11</th>
                        <td>revlon</td>
                        <td>391.31</td>
                      </tr>
                      <tr>
                        <th>12</th>
                        <td>pacifica</td>
                        <td>330.96</td>
                      </tr>
                      <tr>
                        <th>13</th>
                        <td>None</td>
                        <td>252.88</td>
                      </tr>
                      <tr>
                        <th>14</th>
                        <td>pure anada</td>
                        <td>227.99</td>
                      </tr>
                      <tr>
                        <th>15</th>
                        <td>marcelle</td>
                        <td>218.85</td>
                      </tr>
                      <tr>
                        <th>16</th>
                        <td>mineral fusion</td>
                        <td>203.00</td>
                      </tr>
                      <tr>
                        <th>17</th>
                        <td>stila</td>
                        <td>184.99</td>
                      </tr>
                      <tr>
                        <th>18</th>
                        <td>e.l.f.</td>
                        <td>182.73</td>
                      </tr>
                      <tr>
                        <th>19</th>
                        <td>almay</td>
                        <td>177.26</td>
                      </tr>
                      <tr>
                        <th>20</th>
                        <td>glossier</td>
                        <td>150.00</td>
                      </tr>
                      <tr>
                        <th>21</th>
                        <td>sante</td>
                        <td>132.54</td>
                      </tr>
                      <tr>
                        <th>22</th>
                        <td>anna sui</td>
                        <td>132.00</td>
                      </tr>
                      <tr>
                        <th>23</th>
                        <td>milani</td>
                        <td>117.87</td>
                      </tr>
                      <tr>
                        <th>24</th>
                        <td>fenty</td>
                        <td>116.00</td>
                      </tr>
                      <tr>
                        <th>25</th>
                        <td>annabelle</td>
                        <td>107.86</td>
                      </tr>
                      <tr>
                        <th>26</th>
                        <td>suncoat</td>
                        <td>96.04</td>
                      </tr>
                      <tr>
                        <th>27</th>
                        <td>mistura</td>
                        <td>56.49</td>
                      </tr>
                      <tr>
                        <th>28</th>
                        <td>wet n wild</td>
                        <td>51.68</td>
                      </tr>
                      <tr>
                        <th>29</th>
                        <td>zorah</td>
                        <td>51.00</td>
                      </tr>
                      <tr>
                        <th>30</th>
                        <td>butter london</td>
                        <td>50.96</td>
                      </tr>
                      <tr>
                        <th>31</th>
                        <td>moov</td>
                        <td>44.97</td>
                      </tr>
                      <tr>
                        <th>32</th>
                        <td>orly</td>
                        <td>42.98</td>
                      </tr>
                      <tr>
                        <th>33</th>
                        <td>essie</td>
                        <td>40.00</td>
                      </tr>
                      <tr>
                        <th>34</th>
                        <td>colourpop</td>
                        <td>28.00</td>
                      </tr>
                      <tr>
                        <th>35</th>
                        <td>boosh</td>
                        <td>26.00</td>
                      </tr>
                      <tr>
                        <th>36</th>
                        <td>dalish</td>
                        <td>22.00</td>
                      </tr>
                      <tr>
                        <th>37</th>
                        <td>burt's bees</td>
                        <td>19.98</td>
                      </tr>
                      <tr>
                        <th>38</th>
                        <td>deciem</td>
                        <td>13.60</td>
                      </tr>
                      <tr>
                        <th>39</th>
                        <td>piggy paint</td>
                        <td>11.99</td>
                      </tr>
                      <tr>
                        <th>40</th>
                        <td>alva</td>
                        <td>9.95</td>
                      </tr>
                      <tr>
                        <th>41</th>
                        <td>misa</td>
                        <td>9.39</td>
                      </tr>
                      <tr>
                        <th>42</th>
                        <td>china glaze</td>
                        <td>8.00</td>
                      </tr>
                      <tr>
                        <th>43</th>
                        <td>salon perfect</td>
                        <td>6.99</td>
                      </tr>
                      <tr>
                        <th>44</th>
                        <td>sinful colours</td>
                        <td>2.99</td>
                      </tr>
                      <tr>
                        <th>45</th>
                        <td>c'est moi</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>46</th>
                        <td>coastal classic creation</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>47</th>
                        <td>green people</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>48</th>
                        <td>lotus cosmetics usa</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>49</th>
                        <td>maia's mineral galaxy</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>50</th>
                        <td>marienatie</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>51</th>
                        <td>nudus</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>52</th>
                        <td>penny lane organics</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>53</th>
                        <td>rejuva minerals</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>54</th>
                        <td>sally b's skin yummies</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>55</th>
                        <td>w3llpeople</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>56</th>
                        <td>zorah biocosmetiques</td>
                        <td>0.00</td>
                      </tr>
                      <tr>
                        <th>57</th>
                        <td>iman</td>
                        <td>NaN</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: "{}"
          sortingKey: x
          type: sql
        - blockGroup: 45155bbf4f9145599cf825e87b66444e
          content: ""
          executionCount: 43
          id: be25e32dfdc740c8a98bdb540bb07a69
          metadata:
            execution_start: 1763590567298
            execution_millis: 140
            execution_context_id: 66d6a14e-1ed3-4385-9906-1b9addf09387
            deepnote_variable_name: df_2
            deepnote_visualization_spec:
              layer:
                - layer:
                    - layer:
                        - mark:
                            clip: true
                            type: bar
                            color: "#2266D3"
                            tooltip: true
                          encoding:
                            x:
                              axis:
                                format:
                                  type: default
                                  decimals: null
                                formatType: numberFormatFromNumberType
                              type: quantitative
                              field: total_price
                              scale:
                                type: linear
                              format:
                                type: default
                                decimals: null
                              aggregate: sum
                              formatType: numberFormatFromNumberType
                            y:
                              sort: null
                              type: nominal
                              field: brand
                              scale:
                                type: linear
                            color:
                              type: nominal
                              datum: total_price
                              scale:
                                range:
                                  - "#2266D3"
                                domain:
                                  - total_price
                            yOffset:
                              datum: series_0
                          transform: []
                  resolve:
                    scale:
                      color: independent
              title: ""
              config:
                legend:
                  disable: false
              $schema: https://vega.github.io/schema/vega-lite/v5.json
              encoding: {}
              usermeta:
                seriesNames:
                  - total_price
                seriesOrder:
                  - 0
                specSchemaVersion: 2
                tooltipDefaultMode: true
          outputs:
            - output_type: execute_result
              execution_count: 43
              data:
                application/vnd.vega.v5+json:
                  $schema: https://vega.github.io/schema/vega/v5.json
                  data:
                    - name: legend_size_0_store
                    - name: legend_color_0_store
                    - name: interval_selection_store
                    - name: source_0
                      values:
                        - brand: clinique
                          sum_total_price: 2094.3500000000004
                        - brand: dior
                          sum_total_price: 2024.5
                        - brand: nyx
                          sum_total_price: 1380.5800000000002
                        - brand: smashbox
                          sum_total_price: 1373
                        - brand: benefit
                          sum_total_price: 1252
                        - brand: physicians formula
                          sum_total_price: 740.1699999999997
                        - brand: l'oreal
                          sum_total_price: 638.1100000000002
                        - brand: maybelline
                          sum_total_price: 601.46
                        - brand: cargo cosmetics
                          sum_total_price: 585
                        - brand: covergirl
                          sum_total_price: 522.9600000000003
                        - brand: dr. hauschka
                          sum_total_price: 407
                        - brand: revlon
                          sum_total_price: 391.3100000000002
                        - brand: pacifica
                          sum_total_price: 330.96000000000004
                        - brand: null
                          sum_total_price: 252.88000000000002
                        - brand: pure anada
                          sum_total_price: 227.99
                        - brand: marcelle
                          sum_total_price: 218.85000000000005
                        - brand: mineral fusion
                          sum_total_price: 203
                        - brand: stila
                          sum_total_price: 184.99
                        - brand: e.l.f.
                          sum_total_price: 182.73000000000008
                        - brand: almay
                          sum_total_price: 177.26000000000002
                        - brand: glossier
                          sum_total_price: 150
                        - brand: sante
                          sum_total_price: 132.54
                        - brand: anna sui
                          sum_total_price: 132
                        - brand: milani
                          sum_total_price: 117.86999999999998
                        - brand: fenty
                          sum_total_price: 116
                        - brand: annabelle
                          sum_total_price: 107.86
                        - brand: suncoat
                          sum_total_price: 96.03999999999998
                        - brand: mistura
                          sum_total_price: 56.49
                        - brand: wet n wild
                          sum_total_price: 51.680000000000014
                        - brand: zorah
                          sum_total_price: 51
                        - brand: butter london
                          sum_total_price: 50.96
                        - brand: moov
                          sum_total_price: 44.97
                        - brand: orly
                          sum_total_price: 42.980000000000004
                        - brand: essie
                          sum_total_price: 40
                        - brand: colourpop
                          sum_total_price: 28
                        - brand: boosh
                          sum_total_price: 26
                        - brand: dalish
                          sum_total_price: 22
                        - brand: burt's bees
                          sum_total_price: 19.98
                        - brand: deciem
                          sum_total_price: 13.600000000000001
                        - brand: piggy paint
                          sum_total_price: 11.99
                        - brand: alva
                          sum_total_price: 9.95
                        - brand: misa
                          sum_total_price: 9.39
                        - brand: china glaze
                          sum_total_price: 8
                        - brand: salon perfect
                          sum_total_price: 6.99
                        - brand: sinful colours
                          sum_total_price: 2.99
                        - brand: c'est moi
                          sum_total_price: 0
                        - brand: coastal classic creation
                          sum_total_price: 0
                        - brand: green people
                          sum_total_price: 0
                        - brand: lotus cosmetics usa
                          sum_total_price: 0
                        - brand: maia's mineral galaxy
                          sum_total_price: 0
                        - brand: marienatie
                          sum_total_price: 0
                        - brand: nudus
                          sum_total_price: 0
                        - brand: penny lane organics
                          sum_total_price: 0
                        - brand: rejuva minerals
                          sum_total_price: 0
                        - brand: sally b's skin yummies
                          sum_total_price: 0
                        - brand: w3llpeople
                          sum_total_price: 0
                        - brand: zorah biocosmetiques
                          sum_total_price: 0
                    - name: source_0_x_domain_sum_total_price
                      values:
                        - min: 0
                          max: 2094.3500000000004
                    - name: source_0_y_domain_brand
                      values:
                        - brand: clinique
                        - brand: dior
                        - brand: nyx
                        - brand: smashbox
                        - brand: benefit
                        - brand: physicians formula
                        - brand: l'oreal
                        - brand: maybelline
                        - brand: cargo cosmetics
                        - brand: covergirl
                        - brand: dr. hauschka
                        - brand: revlon
                        - brand: pacifica
                        - brand: null
                        - brand: pure anada
                        - brand: marcelle
                        - brand: mineral fusion
                        - brand: stila
                        - brand: e.l.f.
                        - brand: almay
                        - brand: glossier
                        - brand: sante
                        - brand: anna sui
                        - brand: milani
                        - brand: fenty
                        - brand: annabelle
                        - brand: suncoat
                        - brand: mistura
                        - brand: wet n wild
                        - brand: zorah
                        - brand: butter london
                        - brand: moov
                        - brand: orly
                        - brand: essie
                        - brand: colourpop
                        - brand: boosh
                        - brand: dalish
                        - brand: burt's bees
                        - brand: deciem
                        - brand: piggy paint
                        - brand: alva
                        - brand: misa
                        - brand: china glaze
                        - brand: salon perfect
                        - brand: sinful colours
                        - brand: c'est moi
                        - brand: coastal classic creation
                        - brand: green people
                        - brand: lotus cosmetics usa
                        - brand: maia's mineral galaxy
                        - brand: marienatie
                        - brand: nudus
                        - brand: penny lane organics
                        - brand: rejuva minerals
                        - brand: sally b's skin yummies
                        - brand: w3llpeople
                        - brand: zorah biocosmetiques
                  signals:
                    - name: width
                      init: "isFinite(containerSize()[0]) ? containerSize()[0] : 200"
                      on:
                        - events: window:resize
                          update: "isFinite(containerSize()[0]) ? containerSize()[0] : 200"
                    - name: height
                      init: "isFinite(containerSize()[1]) ? containerSize()[1] : 200"
                      on:
                        - events: window:resize
                          update: "isFinite(containerSize()[1]) ? containerSize()[1] : 200"
                    - name: unit
                      value: {}
                      on:
                        - events: pointermove
                          update: "isTuple(group()) ? group() : unit"
                    - name: legend_size_0
                      update: vlSelectionResolve("legend_size_0_store", "union", true, true)
                    - name: legend_color_0
                      update: vlSelectionResolve("legend_color_0_store", "union", true, true)
                    - name: interval_selection
                      update: vlSelectionResolve("interval_selection_store", "union")
                    - name: legend_size_0_tuple
                      on:
                        - events:
                            - source: scope
                              type: click
                          update: "datum && item().mark.marktype !== 'group' && indexof(item().mark.role,
                            'legend') < 0 && indexof(item().mark.name,
                            'interval_selection_brush') < 0 ? {unit:
                            \"layer_0_layer_0_layer_0\", fields:
                            legend_size_0_tuple_fields, values: []} : null"
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: "null"
                    - name: legend_size_0_tuple_fields
                      value: []
                    - name: legend_size_0_toggle
                      value: false
                      on:
                        - events:
                            - source: scope
                              type: click
                          update: "true"
                        - events:
                            - source: view
                              type: dblclick
                          update: "false"
                    - name: legend_size_0_modify
                      on:
                        - events:
                            signal: legend_size_0_tuple
                          update: 'modify("legend_size_0_store", legend_size_0_toggle ? null :
                            legend_size_0_tuple, legend_size_0_toggle ? null :
                            true, legend_size_0_toggle ? legend_size_0_tuple :
                            null)'
                    - name: legend_color_0_tuple
                      on:
                        - events:
                            - source: scope
                              type: click
                          update: "datum && item().mark.marktype !== 'group' && indexof(item().mark.role,
                            'legend') < 0 && indexof(item().mark.name,
                            'interval_selection_brush') < 0 ? {unit:
                            \"layer_0_layer_0_layer_0\", fields:
                            legend_color_0_tuple_fields, values: []} : null"
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: "null"
                    - name: legend_color_0_tuple_fields
                      value: []
                    - name: legend_color_0_toggle
                      value: false
                      on:
                        - events:
                            - source: scope
                              type: click
                          update: "true"
                        - events:
                            - source: view
                              type: dblclick
                          update: "false"
                    - name: legend_color_0_modify
                      on:
                        - events:
                            signal: legend_color_0_tuple
                          update: 'modify("legend_color_0_store", legend_color_0_toggle ? null :
                            legend_color_0_tuple, legend_color_0_toggle ? null :
                            true, legend_color_0_toggle ? legend_color_0_tuple :
                            null)'
                    - name: interval_selection_y
                      value: []
                      on:
                        - events:
                            source: scope
                            filter:
                              - '!event.item || event.item.mark.name !==
                                "interval_selection_brush"'
                            type: pointerdown
                          update: "[y(unit), y(unit)]"
                        - events:
                            source: window
                            between:
                              - source: scope
                                filter:
                                  - '!event.item || event.item.mark.name !==
                                    "interval_selection_brush"'
                                type: pointerdown
                              - source: window
                                type: pointerup
                            consume: true
                            type: pointermove
                          update: "[interval_selection_y[0], clamp(y(unit), 0, height)]"
                        - events:
                            signal: interval_selection_scale_trigger
                          update: "[0, 0]"
                        - events:
                            - source: view
                              type: dblclick
                          update: "[0, 0]"
                        - events:
                            signal: interval_selection_translate_delta
                          update: clampRange(panLinear(interval_selection_translate_anchor.extent_y,
                            interval_selection_translate_delta.y /
                            span(interval_selection_translate_anchor.extent_y)),
                            0, height)
                        - events:
                            signal: interval_selection_zoom_delta
                          update: clampRange(zoomLinear(interval_selection_y,
                            interval_selection_zoom_anchor.y,
                            interval_selection_zoom_delta), 0, height)
                    - name: interval_selection_brand
                      on:
                        - events:
                            signal: interval_selection_y
                          update: 'interval_selection_y[0] === interval_selection_y[1] ? null :
                            invert("y", interval_selection_y)'
                    - name: interval_selection_scale_trigger
                      value: {}
                      on:
                        - events:
                            - scale: y
                          update: '(!isArray(interval_selection_brand) || (invert("y",
                            interval_selection_y)[0] ===
                            interval_selection_brand[0] && invert("y",
                            interval_selection_y)[1] ===
                            interval_selection_brand[1])) ?
                            interval_selection_scale_trigger : {}'
                    - name: interval_selection_tuple
                      on:
                        - events:
                            - signal: interval_selection_brand
                          update: 'interval_selection_brand ? {unit: "layer_0_layer_0_layer_0", fields:
                            interval_selection_tuple_fields, values:
                            [interval_selection_brand]} : null'
                    - name: interval_selection_tuple_fields
                      value:
                        - field: brand
                          channel: y
                          type: E
                    - name: interval_selection_translate_anchor
                      value: {}
                      on:
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: pointerdown
                          update: "{x: x(unit), y: y(unit), extent_y: slice(interval_selection_y)}"
                    - name: interval_selection_translate_delta
                      value: {}
                      on:
                        - events:
                            - source: window
                              between:
                                - source: scope
                                  markname: interval_selection_brush
                                  type: pointerdown
                                - source: window
                                  type: pointerup
                              type: pointermove
                              consume: true
                          update: "{x: interval_selection_translate_anchor.x - x(unit), y:
                            interval_selection_translate_anchor.y - y(unit)}"
                    - name: interval_selection_zoom_anchor
                      on:
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              consume: true
                              type: wheel
                          update: "{x: x(unit), y: y(unit)}"
                    - name: interval_selection_zoom_delta
                      on:
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: wheel
                              consume: true
                          update: pow(1.001, event.deltaY * pow(16, event.deltaMode))
                          force: true
                    - name: interval_selection_modify
                      on:
                        - events:
                            signal: interval_selection_tuple
                          update: modify("interval_selection_store", interval_selection_tuple, true)
                  marks:
                    - type: rect
                      name: interval_selection_brush_bg
                      encode:
                        enter:
                          fill:
                            value: "#333"
                          fillOpacity:
                            value: 0.125
                        update:
                          x2:
                            - field:
                                signal: null
                                datum: null
                                group: width
                                parent: null
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - value: 0
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                          y2:
                            - signal: interval_selection_y[1]
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                          y:
                            - signal: interval_selection_y[0]
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                      clip: true
                    - type: rect
                      name: layer_0_layer_0_layer_0_marks
                      from:
                        data: source_0
                      encode:
                        update:
                          tooltip:
                            signal: '{"Sum of total_price":
                              numberFormatFromNumberType(datum["sum_total_price"],
                              {"decimals":null,"type":"default"}), "brand":
                              isValid(datum["brand"]) ? datum["brand"] :
                              ""+datum["brand"]}'
                          fill:
                            value: total_price
                            scale: layer_0_layer_0_color
                          opacity:
                            - value: 1
                              test: (!length(data("legend_size_0_store")) ||
                                vlSelectionTest("legend_size_0_store", datum))
                                && (!length(data("legend_color_0_store")) ||
                                vlSelectionTest("legend_color_0_store", datum))
                                && (!length(data("interval_selection_store")) ||
                                vlSelectionTest("interval_selection_store",
                                datum))
                            - value: 0.2
                          x:
                            field: sum_total_price
                            scale: x
                          height:
                            signal: max(0.25, bandwidth('yOffset'))
                          y:
                            field: brand
                            scale: y
                            offset:
                              value: series_0
                              scale: yOffset
                          x2:
                            value: 0
                            scale: x
                      style:
                        - bar
                      clip: true
                      interactive: true
                    - type: rect
                      name: interval_selection_brush
                      encode:
                        enter:
                          fill:
                            value: transparent
                          cursor:
                            value: move
                        update:
                          y:
                            - signal: interval_selection_y[0]
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                          stroke:
                            - value: white
                              test: interval_selection_y[0] !== interval_selection_y[1]
                            - {}
                          x:
                            - value: 0
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - field:
                                signal: null
                                datum: null
                                group: width
                                parent: null
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                          y2:
                            - signal: interval_selection_y[1]
                              test: data("interval_selection_store").length &&
                                data("interval_selection_store")[0].unit ===
                                "layer_0_layer_0_layer_0"
                            - value: 0
                      clip: true
                  scales:
                    - name: x
                      type: linear
                      domain:
                        - signal: (data("source_0_x_domain_sum_total_price")[0] || {}).min
                        - signal: (data("source_0_x_domain_sum_total_price")[0] || {}).max
                      range:
                        - 0
                        - signal: width
                      zero: true
                      nice: true
                    - name: y
                      type: band
                      domain:
                        data: source_0_y_domain_brand
                        field: brand
                      range:
                        - 0
                        - signal: height
                      paddingInner: 0.2
                      paddingOuter: 0.2
                    - name: yOffset
                      type: band
                      domain:
                        - series_0
                      range:
                        - 0
                        - signal: bandwidth('y')
                    - name: layer_0_layer_0_color
                      type: ordinal
                      domain:
                        - total_price
                      range:
                        - "#2266D3"
                  axes:
                    - scale: x
                      aria: false
                      zindex: 0
                      tickCount: 5
                      grid: true
                      domain: false
                      gridScale: y
                      labels: false
                      maxExtent: 0
                      orient: bottom
                      minExtent: 0
                      ticks: false
                    - scale: x
                      orient: bottom
                      title: Sum of total_price
                      labelOverlap: true
                      labelFlush: true
                      tickCount: 5
                      encode:
                        labels:
                          update:
                            text:
                              signal: numberFormatFromNumberType(datum.value,
                                {"decimals":null,"type":"default"})
                      zindex: 0
                      grid: false
                    - scale: y
                      orient: left
                      title: brand
                      zindex: 0
                      grid: false
                  usermeta:
                    seriesNames:
                      - total_price
                    tooltipDefaultMode: true
                    specSchemaVersion: 2
                    seriesOrder:
                      - 0
                    outputMetadata:
                      rowLimitExceeded: false
                      rowLimit: 5000
                      filteredDataframeSize: 58
                      columns:
                        - name: brand
                          nativeType: object
                          distinctValues:
                            - almay
                            - anna sui
                            - annabelle
                            - benefit
                            - butter london
                            - cargo cosmetics
                            - clinique
                            - covergirl
                            - dior
                            - dr. hauschka
                            - e.l.f.
                            - fenty
                            - glossier
                            - l'oreal
                            - marcelle
                            - maybelline
                            - milani
                            - mineral fusion
                            - mistura
                            - nyx
                            - pacifica
                            - physicians formula
                            - pure anada
                            - revlon
                            - sante
                            - smashbox
                            - stila
                            - suncoat
                            - wet n wild
                            - zorah
                        - name: total_price
                          nativeType: float64
                          distinctValues:
                            - 51
                            - 51.680000000000014
                            - 56.49
                            - 96.03999999999998
                            - 107.86
                            - 116
                            - 117.86999999999998
                            - 132
                            - 132.54
                            - 150
                            - 177.26000000000002
                            - 182.73000000000008
                            - 184.99
                            - 203
                            - 218.85000000000005
                            - 227.99
                            - 252.88000000000002
                            - 330.96000000000004
                            - 391.3100000000002
                            - 407
                            - 522.9600000000003
                            - 585
                            - 601.46
                            - 638.1100000000002
                            - 740.1699999999997
                            - 1252
                            - 1373
                            - 1380.5800000000002
                            - 2024.5
                            - 2094.3500000000004
                  background: white
                  padding: 5
                  style: cell
                  autosize:
                    type: fit
                    contains: padding
                  legends:
                    - fill: layer_0_layer_0_color
                      symbolType: square
                      encode:
                        symbols:
                          update:
                            opacity:
                              value: 1
                  config:
                    customFormatTypes: true
                    legend:
                      disable: false
                text/plain: <deepnote_toolkit.chart.deepnote_chart.DeepnoteChart at
                  0x7f7ba9d8f090>
              metadata: {}
          sortingKey: y
          type: visualization
        - blockGroup: 6d4217a9116849ec90df42b5ce05dd9e
          content: >-
            Результаты

            По итогам расчётов:

            В категорию A попали крупнейшие бренды, такие как clinique, dior,
            nyx, smashbox, обеспечивающие максимальный вклад в общую стоимость
            ассортимента.

            Категория B включает бренды со средним вкладом (maybelline, l'oreal,
            cargo cosmetics и др.).

            Категория C включает наименее значимые бренды — их вклад в общую
            стоимость минимален.

            Визуализация (столбчатая диаграмма) показывает резкое падение суммы
            цен после первых крупных брендов, что подтверждает характерную для
            ABC-анализа концентрацию ассортимента.

            Выводы

            Ассортимент распределён неравномерно: небольшое количество брендов
            формирует большую часть совокупной стоимости.

            Для оптимизации ассортимента или маркетинговой активности
            целесообразно уделять приоритетное внимание брендам категории A.

            Категории B и C могут использоваться для расширения ассортимента, но
            не требуют столь высокого уровня управления.
          id: 8c49d0a96833400dae2f8a7cb80a0c20
          metadata:
            formattedRanges:
              - type: marks
                marks:
                  bold: true
                toCodePoint: 10
                fromCodePoint: 0
              - type: marks
                marks:
                  bold: true
                toCodePoint: 537
                fromCodePoint: 531
          sortingKey: yU
          type: text-cell-p
        - blockGroup: b036a2715b7e463a85711e79030bf119
          content: >
            SELECT
              brand,
              AVG(CAST(price AS FLOAT64)) AS avg_price,
              STDDEV(CAST(price AS FLOAT64)) AS std_price,
              STDDEV(CAST(price AS FLOAT64)) / NULLIF(AVG(CAST(price AS FLOAT64)), 0) AS cv
            FROM `cosmeticres.makeup_dataset.makeup`

            WHERE price IS NOT NULL 
              AND CAST(price AS FLOAT64) > 0
            GROUP BY brand

            HAVING avg_price > 0

            ORDER BY cv ASC;
          executionCount: 22
          id: 8badfbd1a2d24b11b5ba3b5ecc2277ee
          metadata:
            execution_start: 1763592767416
            execution_millis: 2153
            sql_integration_id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
            deepnote_table_state:
              sortBy: []
              filters: []
              pageSize: 10
              pageIndex: 0
              columnOrder:
                - brand
                - avg_price
                - std_price
                - cv
              hiddenColumnIds: []
              columnDisplayNames: []
              conditionalFilters: []
              cellFormattingRules: []
              wrappedTextColumnIds: []
            execution_context_id: cdf18529-7204-4d34-9a77-bbde979e9f5a
            deepnote_table_loading: false
            deepnote_variable_name: df_xyz_source
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 4097
                  compiled_query: |-
                    SELECT
                      brand,
                      AVG(CAST(price AS FLOAT64)) AS avg_price,
                      STDDEV(CAST(price AS FLOAT64)) AS std_price,
                      STDDEV(CAST(price AS FLOAT64)) / NULLIF(AVG(CAST(price AS FLOAT64)), 0) AS cv
                    FROM `cosmeticres.makeup_dataset.makeup`
                    WHERE price IS NOT NULL 
                      AND CAST(price AS FLOAT64) > 0
                    GROUP BY brand
                    HAVING avg_price > 0
                    ORDER BY cv ASC
                    /* {"app":"deepnote","submitted_by":"user","user_email":"darja.kuz2011@gmail.com","workspace_id":"5d927472-4f07-433e-9737-70a3fdd0c4d7","project_id":"bf6444c3-7e28-4718-a4cc-15d838d50389","notebook_id":"8bd7ecef2a68464496b2d68a96921f61","project_url":"https://deepnote.com/project/bf6444c3-7e28-4718-a4cc-15d838d50389"} */;
                  variable_type: dataframe
                  integration_id: 23c84bad-99e0-4b85-9aaf-ddaa10cd3b66
              metadata: {}
              output_type: display_data
            - output_type: execute_result
              execution_count: 22
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 4
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 44
                        nan_count: 1
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: dalish
                            count: 1
                          - name: 43 others
                            count: 43
                          - name: Missing
                            count: 1
                    - name: avg_price
                      dtype: float64
                      stats:
                        unique_count: 44
                        nan_count: 0
                        min: "2.99"
                        max: "56.49"
                        histogram:
                          - bin_start: 2.99
                            bin_end: 8.34
                            count: 7
                          - bin_start: 8.34
                            bin_end: 13.69
                            count: 13
                          - bin_start: 13.69
                            bin_end: 19.04
                            count: 6
                          - bin_start: 19.04
                            bin_end: 24.39
                            count: 6
                          - bin_start: 24.39
                            bin_end: 29.740000000000002
                            count: 8
                          - bin_start: 29.740000000000002
                            bin_end: 35.089999999999996
                            count: 3
                          - bin_start: 35.089999999999996
                            bin_end: 40.44
                            count: 0
                          - bin_start: 40.44
                            bin_end: 45.79
                            count: 0
                          - bin_start: 45.79
                            bin_end: 51.14
                            count: 1
                          - bin_start: 51.14
                            bin_end: 56.49
                            count: 1
                        categories: null
                    - name: std_price
                      dtype: float64
                      stats:
                        unique_count: 34
                        nan_count: 9
                        min: "0.0"
                        max: "11.62432793756267"
                        histogram:
                          - bin_start: 0
                            bin_end: 1.162432793756267
                            count: 4
                          - bin_start: 1.162432793756267
                            bin_end: 2.324865587512534
                            count: 3
                          - bin_start: 2.324865587512534
                            bin_end: 3.4872983812688014
                            count: 8
                          - bin_start: 3.4872983812688014
                            bin_end: 4.649731175025068
                            count: 6
                          - bin_start: 4.649731175025068
                            bin_end: 5.812163968781335
                            count: 2
                          - bin_start: 5.812163968781335
                            bin_end: 6.974596762537603
                            count: 4
                          - bin_start: 6.974596762537603
                            bin_end: 8.13702955629387
                            count: 3
                          - bin_start: 8.13702955629387
                            bin_end: 9.299462350050137
                            count: 0
                          - bin_start: 9.299462350050137
                            bin_end: 10.461895143806403
                            count: 2
                          - bin_start: 10.461895143806403
                            bin_end: 11.62432793756267
                            count: 4
                        categories: null
                    - name: cv
                      dtype: float64
                      stats:
                        unique_count: 34
                        nan_count: 9
                        min: "0.0"
                        max: "0.4919523888859366"
                        histogram:
                          - bin_start: 0
                            bin_end: 0.04919523888859366
                            count: 4
                          - bin_start: 0.04919523888859366
                            bin_end: 0.09839047777718732
                            count: 1
                          - bin_start: 0.09839047777718732
                            bin_end: 0.14758571666578096
                            count: 0
                          - bin_start: 0.14758571666578096
                            bin_end: 0.19678095555437464
                            count: 5
                          - bin_start: 0.19678095555437464
                            bin_end: 0.2459761944429683
                            count: 4
                          - bin_start: 0.2459761944429683
                            bin_end: 0.2951714333315619
                            count: 6
                          - bin_start: 0.2951714333315619
                            bin_end: 0.3443666722201556
                            count: 5
                          - bin_start: 0.3443666722201556
                            bin_end: 0.3935619111087493
                            count: 5
                          - bin_start: 0.3935619111087493
                            bin_end: 0.44275714999734295
                            count: 1
                          - bin_start: 0.44275714999734295
                            bin_end: 0.4919523888859366
                            count: 5
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 45
                  preview_row_count: 45
                  rows:
                    - brand: dalish
                      avg_price: 22
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 0
                    - brand: boosh
                      avg_price: 26
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 1
                    - brand: piggy paint
                      avg_price: 11.99
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 2
                    - brand: alva
                      avg_price: 9.95
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 3
                    - brand: sinful colours
                      avg_price: 2.99
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 4
                    - brand: china glaze
                      avg_price: 8
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 5
                    - brand: salon perfect
                      avg_price: 6.99
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 6
                    - brand: misa
                      avg_price: 9.39
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 7
                    - brand: mistura
                      avg_price: 56.49
                      std_price: nan
                      cv: nan
                      _deepnote_index_column: 8
                    - brand: essie
                      avg_price: 10
                      std_price: 0
                      cv: 0
                      _deepnote_index_column: 9
                  type: dataframe
                text/plain: |2-
                                   brand  avg_price  std_price        cv
                  0               dalish  22.000000        NaN       NaN
                  1                boosh  26.000000        NaN       NaN
                  2          piggy paint  11.990000        NaN       NaN
                  3                 alva   9.950000        NaN       NaN
                  4       sinful colours   2.990000        NaN       NaN
                  5          china glaze   8.000000        NaN       NaN
                  6        salon perfect   6.990000        NaN       NaN
                  7                 misa   9.390000        NaN       NaN
                  8              mistura  56.490000        NaN       NaN
                  9                essie  10.000000   0.000000  0.000000
                  10         burt's bees   9.990000   0.000000  0.000000
                  11                moov  14.990000   0.000000  0.000000
                  12              deciem   6.800000   0.141421  0.020797
                  13               zorah  25.500000   2.121320  0.083189
                  14           annabelle   9.805455   1.472626  0.150184
                  15               stila  46.247500   7.088373  0.153270
                  16               sante  22.090000   3.750200  0.169769
                  17            glossier  25.000000   4.472136  0.178885
                  18       butter london  25.480000   4.921463  0.193150
                  19     cargo cosmetics  29.250000   6.264982  0.214187
                  20        dr. hauschka  33.916667   7.668807  0.226107
                  21               almay  12.661429   2.891746  0.228390
                  22  physicians formula  17.213256   4.117433  0.239201
                  23              milani   9.066923   2.396579  0.264321
                  24            marcelle  14.590000   3.906039  0.267720
                  25           covergirl   9.684444   2.608796  0.269380
                  26               fenty  23.200000   6.610598  0.284940
                  27            clinique  22.764674   6.524070  0.286587
                  28                orly  10.745000   3.169653  0.294989
                  29          maybelline  11.138148   3.290108  0.295391
                  30              revlon  13.493448   4.063908  0.301176
                  31                 nyx   8.469816   2.772462  0.327334
                  32             l'oreal  13.871957   4.554460  0.328321
                  33            anna sui  22.000000   7.563068  0.343776
                  34             benefit  30.536585  10.587959  0.346730
                  35                dior  28.514085  10.257044  0.359718
                  36            smashbox  29.847826  10.776450  0.361046
                  37          pure anada  14.249375   5.156000  0.361840
                  38             suncoat  16.006667   6.163251  0.385043
                  39              e.l.f.   6.767778   2.764241  0.408441
                  40            pacifica  25.458462  11.570542  0.454487
                  41      mineral fusion  25.375000  11.624328  0.458102
                  42          wet n wild   4.306667   2.043541  0.474506
                  43           colourpop   7.000000   3.341656  0.477379
                  44                None  21.073333  10.367077  0.491952
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>avg_price</th>
                        <th>std_price</th>
                        <th>cv</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>dalish</td>
                        <td>22.000000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>boosh</td>
                        <td>26.000000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>piggy paint</td>
                        <td>11.990000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>alva</td>
                        <td>9.950000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>sinful colours</td>
                        <td>2.990000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>5</th>
                        <td>china glaze</td>
                        <td>8.000000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>6</th>
                        <td>salon perfect</td>
                        <td>6.990000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>7</th>
                        <td>misa</td>
                        <td>9.390000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>8</th>
                        <td>mistura</td>
                        <td>56.490000</td>
                        <td>NaN</td>
                        <td>NaN</td>
                      </tr>
                      <tr>
                        <th>9</th>
                        <td>essie</td>
                        <td>10.000000</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                      </tr>
                      <tr>
                        <th>10</th>
                        <td>burt's bees</td>
                        <td>9.990000</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                      </tr>
                      <tr>
                        <th>11</th>
                        <td>moov</td>
                        <td>14.990000</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                      </tr>
                      <tr>
                        <th>12</th>
                        <td>deciem</td>
                        <td>6.800000</td>
                        <td>0.141421</td>
                        <td>0.020797</td>
                      </tr>
                      <tr>
                        <th>13</th>
                        <td>zorah</td>
                        <td>25.500000</td>
                        <td>2.121320</td>
                        <td>0.083189</td>
                      </tr>
                      <tr>
                        <th>14</th>
                        <td>annabelle</td>
                        <td>9.805455</td>
                        <td>1.472626</td>
                        <td>0.150184</td>
                      </tr>
                      <tr>
                        <th>15</th>
                        <td>stila</td>
                        <td>46.247500</td>
                        <td>7.088373</td>
                        <td>0.153270</td>
                      </tr>
                      <tr>
                        <th>16</th>
                        <td>sante</td>
                        <td>22.090000</td>
                        <td>3.750200</td>
                        <td>0.169769</td>
                      </tr>
                      <tr>
                        <th>17</th>
                        <td>glossier</td>
                        <td>25.000000</td>
                        <td>4.472136</td>
                        <td>0.178885</td>
                      </tr>
                      <tr>
                        <th>18</th>
                        <td>butter london</td>
                        <td>25.480000</td>
                        <td>4.921463</td>
                        <td>0.193150</td>
                      </tr>
                      <tr>
                        <th>19</th>
                        <td>cargo cosmetics</td>
                        <td>29.250000</td>
                        <td>6.264982</td>
                        <td>0.214187</td>
                      </tr>
                      <tr>
                        <th>20</th>
                        <td>dr. hauschka</td>
                        <td>33.916667</td>
                        <td>7.668807</td>
                        <td>0.226107</td>
                      </tr>
                      <tr>
                        <th>21</th>
                        <td>almay</td>
                        <td>12.661429</td>
                        <td>2.891746</td>
                        <td>0.228390</td>
                      </tr>
                      <tr>
                        <th>22</th>
                        <td>physicians formula</td>
                        <td>17.213256</td>
                        <td>4.117433</td>
                        <td>0.239201</td>
                      </tr>
                      <tr>
                        <th>23</th>
                        <td>milani</td>
                        <td>9.066923</td>
                        <td>2.396579</td>
                        <td>0.264321</td>
                      </tr>
                      <tr>
                        <th>24</th>
                        <td>marcelle</td>
                        <td>14.590000</td>
                        <td>3.906039</td>
                        <td>0.267720</td>
                      </tr>
                      <tr>
                        <th>25</th>
                        <td>covergirl</td>
                        <td>9.684444</td>
                        <td>2.608796</td>
                        <td>0.269380</td>
                      </tr>
                      <tr>
                        <th>26</th>
                        <td>fenty</td>
                        <td>23.200000</td>
                        <td>6.610598</td>
                        <td>0.284940</td>
                      </tr>
                      <tr>
                        <th>27</th>
                        <td>clinique</td>
                        <td>22.764674</td>
                        <td>6.524070</td>
                        <td>0.286587</td>
                      </tr>
                      <tr>
                        <th>28</th>
                        <td>orly</td>
                        <td>10.745000</td>
                        <td>3.169653</td>
                        <td>0.294989</td>
                      </tr>
                      <tr>
                        <th>29</th>
                        <td>maybelline</td>
                        <td>11.138148</td>
                        <td>3.290108</td>
                        <td>0.295391</td>
                      </tr>
                      <tr>
                        <th>30</th>
                        <td>revlon</td>
                        <td>13.493448</td>
                        <td>4.063908</td>
                        <td>0.301176</td>
                      </tr>
                      <tr>
                        <th>31</th>
                        <td>nyx</td>
                        <td>8.469816</td>
                        <td>2.772462</td>
                        <td>0.327334</td>
                      </tr>
                      <tr>
                        <th>32</th>
                        <td>l'oreal</td>
                        <td>13.871957</td>
                        <td>4.554460</td>
                        <td>0.328321</td>
                      </tr>
                      <tr>
                        <th>33</th>
                        <td>anna sui</td>
                        <td>22.000000</td>
                        <td>7.563068</td>
                        <td>0.343776</td>
                      </tr>
                      <tr>
                        <th>34</th>
                        <td>benefit</td>
                        <td>30.536585</td>
                        <td>10.587959</td>
                        <td>0.346730</td>
                      </tr>
                      <tr>
                        <th>35</th>
                        <td>dior</td>
                        <td>28.514085</td>
                        <td>10.257044</td>
                        <td>0.359718</td>
                      </tr>
                      <tr>
                        <th>36</th>
                        <td>smashbox</td>
                        <td>29.847826</td>
                        <td>10.776450</td>
                        <td>0.361046</td>
                      </tr>
                      <tr>
                        <th>37</th>
                        <td>pure anada</td>
                        <td>14.249375</td>
                        <td>5.156000</td>
                        <td>0.361840</td>
                      </tr>
                      <tr>
                        <th>38</th>
                        <td>suncoat</td>
                        <td>16.006667</td>
                        <td>6.163251</td>
                        <td>0.385043</td>
                      </tr>
                      <tr>
                        <th>39</th>
                        <td>e.l.f.</td>
                        <td>6.767778</td>
                        <td>2.764241</td>
                        <td>0.408441</td>
                      </tr>
                      <tr>
                        <th>40</th>
                        <td>pacifica</td>
                        <td>25.458462</td>
                        <td>11.570542</td>
                        <td>0.454487</td>
                      </tr>
                      <tr>
                        <th>41</th>
                        <td>mineral fusion</td>
                        <td>25.375000</td>
                        <td>11.624328</td>
                        <td>0.458102</td>
                      </tr>
                      <tr>
                        <th>42</th>
                        <td>wet n wild</td>
                        <td>4.306667</td>
                        <td>2.043541</td>
                        <td>0.474506</td>
                      </tr>
                      <tr>
                        <th>43</th>
                        <td>colourpop</td>
                        <td>7.000000</td>
                        <td>3.341656</td>
                        <td>0.477379</td>
                      </tr>
                      <tr>
                        <th>44</th>
                        <td>None</td>
                        <td>21.073333</td>
                        <td>10.367077</td>
                        <td>0.491952</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: '{"sortBy":[],"filters":[],"pageSize":10,"pageIndex":0,"columnOrder":["brand","avg_price","std_price","cv"],"hiddenColumnIds":[],"columnDisplayNames":[],"conditionalFilters":[],"cellFormattingRules":[],"wrappedTextColumnIds":[]}'
          sortingKey: yj
          type: sql
        - blockGroup: bf9972cf779c4c20b467cebb8ac3b2ac
          content: "!pip install duckdb"
          executionCount: 55
          id: e6e1b92c3e074aa0b1114d60d9270395
          metadata:
            execution_start: 1763591776765
            execution_millis: 4348
            execution_context_id: 66d6a14e-1ed3-4385-9906-1b9addf09387
          outputs:
            - name: stdout
              text: "Requirement already satisfied: duckdb in
                /toolkit-cache/1.1.4/python3.11/kernel-libs/lib/python3.11/site\
                -packages (1.4.1)


                \e[1m[\e[0m\e[34;49mnotice\e[0m\e[1;39;49m]\e[0m\e[39;49m A new
                release of pip is available: \e[0m\e[31;49m24.0\e[0m\e[39;49m ->
                \e[0m\e[32;49m25.3\e[0m

                \e[1m[\e[0m\e[34;49mnotice\e[0m\e[1;39;49m]\e[0m\e[39;49m To
                update, run: \e[0m\e[32;49mpip install --upgrade pip\e[0m\n"
              output_type: stream
          sortingKey: yr
          type: code
        - blockGroup: d86099f3a68a49f4967aee5a0d055be7
          content: Попробуем провести RFM-анализ через duck db
          id: 6799d07a5091497aa4b712035660bc97
          metadata:
            formattedRanges: []
          sortingKey: yv
          type: text-cell-p
        - blockGroup: 0778c15026de438297e86e4e6809302a
          content: |-
            import duckdb
            duckdb.__version__
          executionCount: 58
          id: 26b6b49157024a3cb74e3e36d8c397c4
          metadata:
            execution_start: 1763591971675
            execution_millis: 1
            execution_context_id: 66d6a14e-1ed3-4385-9906-1b9addf09387
          outputs:
            - output_type: execute_result
              execution_count: 58
              data:
                text/plain: "'1.4.1'"
              metadata: {}
          sortingKey: yx
          type: code
        - blockGroup: 0df1eb72f68348cca7581ac5b309b1a3
          content: whos
          executionCount: 31
          id: e25506221e7c4d439fbc35be8b29788e
          metadata:
            execution_start: 1763592880077
            execution_millis: 0
            execution_context_id: cdf18529-7204-4d34-9a77-bbde979e9f5a
          outputs:
            - name: stdout
              text: |
                Variable        Type                  Data/Info
                -----------------------------------------------
                con             DuckDBPyConnection    <_duckdb.DuckDBPyConnecti<...>object at 0x7f20c6a28730>
                df_xyz_source   DataFrame             Shape: (45, 4)
                duckdb          module                <module 'duckdb' from '/t<...>ages/duckdb/__init__.py'>
                os              module                <module 'os' (frozen)>
                xyz_source      DataFrame             Shape: (45, 4)
              output_type: stream
          sortingKey: yxU
          type: code
        - blockGroup: 768e8f07356c4229b5847204c504049f
          content: |
            import duckdb

            con = duckdb.connect()
            con.register("xyz_source", df_xyz_source)
          executionCount: 25
          id: 5d717cb080a245a09df7a25529586a48
          metadata:
            execution_start: 1763592774971
            execution_millis: 49
            execution_context_id: cdf18529-7204-4d34-9a77-bbde979e9f5a
          outputs:
            - output_type: execute_result
              execution_count: 25
              data:
                text/plain: <_duckdb.DuckDBPyConnection at 0x7f20c6a28730>
              metadata: {}
          sortingKey: yy
          type: code
        - blockGroup: 5ab3b553a582401dbc5c02b4112c174e
          content: |-
            import pandas as pd

            df_raw = pd.read_json("makeup_data.json")
            df_raw = df_raw[["brand", "price"]].dropna()
            df_raw = df_raw[df_raw["price"] > 0]
            df_raw.head()
          executionCount: 34
          id: 6832f1c66e9b4ecfa8588907606c89dc
          metadata:
            execution_start: 1763593071337
            execution_millis: 577
            execution_context_id: cdf18529-7204-4d34-9a77-bbde979e9f5a
          outputs:
            - output_type: execute_result
              execution_count: 34
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 2
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 2
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: colourpop
                            count: 4
                          - name: boosh
                            count: 1
                    - name: price
                      dtype: float64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "5.0"
                        max: "26.0"
                        histogram:
                          - bin_start: 5
                            bin_end: 7.1
                            count: 3
                          - bin_start: 7.1
                            bin_end: 9.2
                            count: 0
                          - bin_start: 9.2
                            bin_end: 11.3
                            count: 0
                          - bin_start: 11.3
                            bin_end: 13.4
                            count: 1
                          - bin_start: 13.4
                            bin_end: 15.5
                            count: 0
                          - bin_start: 15.5
                            bin_end: 17.6
                            count: 0
                          - bin_start: 17.6
                            bin_end: 19.700000000000003
                            count: 0
                          - bin_start: 19.700000000000003
                            bin_end: 21.8
                            count: 0
                          - bin_start: 21.8
                            bin_end: 23.900000000000002
                            count: 0
                          - bin_start: 23.900000000000002
                            bin_end: 26
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: colourpop
                      price: 5
                      _deepnote_index_column: 0
                    - brand: colourpop
                      price: 5.5
                      _deepnote_index_column: 1
                    - brand: colourpop
                      price: 5.5
                      _deepnote_index_column: 2
                    - brand: colourpop
                      price: 12
                      _deepnote_index_column: 3
                    - brand: boosh
                      price: 26
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                         brand  price
                  0  colourpop    5.0
                  1  colourpop    5.5
                  2  colourpop    5.5
                  3  colourpop   12.0
                  4      boosh   26.0
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>price</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>colourpop</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>colourpop</td>
                        <td>5.5</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>colourpop</td>
                        <td>5.5</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>colourpop</td>
                        <td>12.0</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>boosh</td>
                        <td>26.0</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: "{}"
          sortingKey: yyU
          type: code
        - blockGroup: 3c3483085a4d44d6b03e43f885e462fc
          content: |
            import duckdb

            con = duckdb.connect()
            con.register("raw_data", df_raw)
          executionCount: 37
          id: 663feb949d4c470bb2863d4bf4d48c23
          metadata:
            execution_start: 1763593093006
            execution_millis: 2332
            execution_context_id: cdf18529-7204-4d34-9a77-bbde979e9f5a
          outputs:
            - output_type: execute_result
              execution_count: 37
              data:
                text/plain: <_duckdb.DuckDBPyConnection at 0x7f20c6a43330>
              metadata: {}
          sortingKey: yyj
          type: code
        - blockGroup: a70f72ff991f407e9d36de3c4111e83b
          content: |
            con.execute("SELECT * FROM raw_data LIMIT 5").df()
          id: 5672081c63844afcbf9520ec36f45e88
          metadata: {}
          outputs: []
          sortingKey: yyr
          type: code
        - blockGroup: c9132da7b315407591acc98823087bf1
          content: |
            import duckdb
            import pandas as pd

            # Подгружаем исходные данные из файла
            df_raw = pd.read_json("makeup_data.json")

            # Берём только brand и price
            df_raw = df_raw[["brand", "price"]].dropna()
            df_raw = df_raw[df_raw["price"] > 0]

            # Создаём соединение DuckDB
            con = duckdb.connect()

            # Регистрируем таблицу
            con.register("raw_data", df_raw)

            df_raw.head()
          executionCount: 4
          id: fc30f80276e949609d4a2729a645c3dd
          metadata:
            execution_start: 1763593403171
            execution_millis: 329
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 4
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 2
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 2
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: colourpop
                            count: 4
                          - name: boosh
                            count: 1
                    - name: price
                      dtype: float64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "5.0"
                        max: "26.0"
                        histogram:
                          - bin_start: 5
                            bin_end: 7.1
                            count: 3
                          - bin_start: 7.1
                            bin_end: 9.2
                            count: 0
                          - bin_start: 9.2
                            bin_end: 11.3
                            count: 0
                          - bin_start: 11.3
                            bin_end: 13.4
                            count: 1
                          - bin_start: 13.4
                            bin_end: 15.5
                            count: 0
                          - bin_start: 15.5
                            bin_end: 17.6
                            count: 0
                          - bin_start: 17.6
                            bin_end: 19.700000000000003
                            count: 0
                          - bin_start: 19.700000000000003
                            bin_end: 21.8
                            count: 0
                          - bin_start: 21.8
                            bin_end: 23.900000000000002
                            count: 0
                          - bin_start: 23.900000000000002
                            bin_end: 26
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: colourpop
                      price: 5
                      _deepnote_index_column: 0
                    - brand: colourpop
                      price: 5.5
                      _deepnote_index_column: 1
                    - brand: colourpop
                      price: 5.5
                      _deepnote_index_column: 2
                    - brand: colourpop
                      price: 12
                      _deepnote_index_column: 3
                    - brand: boosh
                      price: 26
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                         brand  price
                  0  colourpop    5.0
                  1  colourpop    5.5
                  2  colourpop    5.5
                  3  colourpop   12.0
                  4      boosh   26.0
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>price</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>colourpop</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>colourpop</td>
                        <td>5.5</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>colourpop</td>
                        <td>5.5</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>colourpop</td>
                        <td>12.0</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>boosh</td>
                        <td>26.0</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyv
          type: code
        - blockGroup: 5a25f1058da548b19d08a76ba31cbf73
          content: |
            query_xyz = """
            SELECT
                brand,
                AVG(price) AS avg_price,
                STDDEV(price) AS std_price,
                STDDEV(price) / NULLIF(AVG(price), 0) AS cv,
                COUNT(*) AS n_items
            FROM raw_data
            GROUP BY brand
            HAVING n_items > 1 AND avg_price > 0
            ORDER BY cv ASC
            """

            df_xyz = con.execute(query_xyz).df()
            df_xyz.head()
          executionCount: 7
          id: 8850dc294437411ab4ad6694d46605bc
          metadata:
            execution_start: 1763593415505
            execution_millis: 18
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 7
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 5
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: burt's bees
                            count: 1
                          - name: essie
                            count: 1
                          - name: 3 others
                            count: 3
                    - name: avg_price
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "6.800000000000001"
                        max: "25.5"
                        histogram:
                          - bin_start: 6.800000000000001
                            bin_end: 8.67
                            count: 1
                          - bin_start: 8.67
                            bin_end: 10.540000000000001
                            count: 2
                          - bin_start: 10.540000000000001
                            bin_end: 12.41
                            count: 0
                          - bin_start: 12.41
                            bin_end: 14.280000000000001
                            count: 0
                          - bin_start: 14.280000000000001
                            bin_end: 16.15
                            count: 1
                          - bin_start: 16.15
                            bin_end: 18.02
                            count: 0
                          - bin_start: 18.02
                            bin_end: 19.89
                            count: 0
                          - bin_start: 19.89
                            bin_end: 21.759999999999998
                            count: 0
                          - bin_start: 21.759999999999998
                            bin_end: 23.63
                            count: 0
                          - bin_start: 23.63
                            bin_end: 25.5
                            count: 1
                        categories: null
                    - name: std_price
                      dtype: float64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: "0.0"
                        max: "2.1213203435596424"
                        histogram:
                          - bin_start: 0
                            bin_end: 0.21213203435596423
                            count: 4
                          - bin_start: 0.21213203435596423
                            bin_end: 0.42426406871192845
                            count: 0
                          - bin_start: 0.42426406871192845
                            bin_end: 0.6363961030678926
                            count: 0
                          - bin_start: 0.6363961030678926
                            bin_end: 0.8485281374238569
                            count: 0
                          - bin_start: 0.8485281374238569
                            bin_end: 1.0606601717798212
                            count: 0
                          - bin_start: 1.0606601717798212
                            bin_end: 1.2727922061357853
                            count: 0
                          - bin_start: 1.2727922061357853
                            bin_end: 1.4849242404917495
                            count: 0
                          - bin_start: 1.4849242404917495
                            bin_end: 1.6970562748477138
                            count: 0
                          - bin_start: 1.6970562748477138
                            bin_end: 1.909188309203678
                            count: 0
                          - bin_start: 1.909188309203678
                            bin_end: 2.1213203435596424
                            count: 1
                        categories: null
                    - name: cv
                      dtype: float64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: "0.0"
                        max: "0.08318903308077029"
                        histogram:
                          - bin_start: 0
                            bin_end: 0.008318903308077028
                            count: 3
                          - bin_start: 0.008318903308077028
                            bin_end: 0.016637806616154056
                            count: 0
                          - bin_start: 0.016637806616154056
                            bin_end: 0.024956709924231085
                            count: 1
                          - bin_start: 0.024956709924231085
                            bin_end: 0.03327561323230811
                            count: 0
                          - bin_start: 0.03327561323230811
                            bin_end: 0.04159451654038514
                            count: 0
                          - bin_start: 0.04159451654038514
                            bin_end: 0.04991341984846217
                            count: 0
                          - bin_start: 0.04991341984846217
                            bin_end: 0.0582323231565392
                            count: 0
                          - bin_start: 0.0582323231565392
                            bin_end: 0.06655122646461623
                            count: 0
                          - bin_start: 0.06655122646461623
                            bin_end: 0.07487012977269325
                            count: 0
                          - bin_start: 0.07487012977269325
                            bin_end: 0.08318903308077029
                            count: 1
                        categories: null
                    - name: n_items
                      dtype: int64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: "2"
                        max: "4"
                        histogram:
                          - bin_start: 2
                            bin_end: 2.2
                            count: 3
                          - bin_start: 2.2
                            bin_end: 2.4
                            count: 0
                          - bin_start: 2.4
                            bin_end: 2.6
                            count: 0
                          - bin_start: 2.6
                            bin_end: 2.8
                            count: 0
                          - bin_start: 2.8
                            bin_end: 3
                            count: 0
                          - bin_start: 3
                            bin_end: 3.2
                            count: 1
                          - bin_start: 3.2
                            bin_end: 3.4000000000000004
                            count: 0
                          - bin_start: 3.4000000000000004
                            bin_end: 3.6
                            count: 0
                          - bin_start: 3.6
                            bin_end: 3.8
                            count: 0
                          - bin_start: 3.8
                            bin_end: 4
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: burt's bees
                      avg_price: 9.99
                      std_price: 0
                      cv: 0
                      n_items: 2
                      _deepnote_index_column: 0
                    - brand: essie
                      avg_price: 10
                      std_price: 0
                      cv: 0
                      n_items: 4
                      _deepnote_index_column: 1
                    - brand: moov
                      avg_price: 14.99
                      std_price: 0
                      cv: 0
                      n_items: 3
                      _deepnote_index_column: 2
                    - brand: deciem
                      avg_price: 6.800000000000001
                      std_price: 0.1414213562373093
                      cv: 0.020797258270192544
                      n_items: 2
                      _deepnote_index_column: 3
                    - brand: zorah
                      avg_price: 25.5
                      std_price: 2.1213203435596424
                      cv: 0.08318903308077029
                      n_items: 2
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                           brand  avg_price  std_price        cv  n_items
                  0  burt's bees       9.99   0.000000  0.000000        2
                  1        essie      10.00   0.000000  0.000000        4
                  2         moov      14.99   0.000000  0.000000        3
                  3       deciem       6.80   0.141421  0.020797        2
                  4        zorah      25.50   2.121320  0.083189        2
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>avg_price</th>
                        <th>std_price</th>
                        <th>cv</th>
                        <th>n_items</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>burt's bees</td>
                        <td>9.99</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                        <td>2</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>essie</td>
                        <td>10.00</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                        <td>4</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>moov</td>
                        <td>14.99</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                        <td>3</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>deciem</td>
                        <td>6.80</td>
                        <td>0.141421</td>
                        <td>0.020797</td>
                        <td>2</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>zorah</td>
                        <td>25.50</td>
                        <td>2.121320</td>
                        <td>0.083189</td>
                        <td>2</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyx
          type: code
        - blockGroup: 8605d165c76d470e8c7ddf3c8f93eb42
          content: |
            df_xyz["category"] = df_xyz["cv"].apply(
                lambda x: "X" if x < 0.10 else ("Y" if x < 0.25 else "Z")
            )

            df_xyz
          executionCount: 10
          id: 47d1fbe99acd4807816f9256c0a4aa92
          metadata:
            execution_start: 1763593428581
            execution_millis: 1
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 10
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 6
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 35
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: burt's bees
                            count: 1
                          - name: essie
                            count: 1
                          - name: 33 others
                            count: 33
                    - name: avg_price
                      dtype: float64
                      stats:
                        unique_count: 35
                        nan_count: 0
                        min: "4.3066666666666675"
                        max: "46.2475"
                        histogram:
                          - bin_start: 4.3066666666666675
                            bin_end: 8.50075
                            count: 5
                          - bin_start: 8.50075
                            bin_end: 12.694833333333335
                            count: 8
                          - bin_start: 12.694833333333335
                            bin_end: 16.888916666666667
                            count: 6
                          - bin_start: 16.888916666666667
                            bin_end: 21.083000000000002
                            count: 1
                          - bin_start: 21.083000000000002
                            bin_end: 25.277083333333334
                            count: 5
                          - bin_start: 25.277083333333334
                            bin_end: 29.47116666666667
                            count: 6
                          - bin_start: 29.47116666666667
                            bin_end: 33.66525
                            count: 2
                          - bin_start: 33.66525
                            bin_end: 37.85933333333333
                            count: 1
                          - bin_start: 37.85933333333333
                            bin_end: 42.053416666666664
                            count: 0
                          - bin_start: 42.053416666666664
                            bin_end: 46.2475
                            count: 1
                        categories: null
                    - name: std_price
                      dtype: float64
                      stats:
                        unique_count: 33
                        nan_count: 0
                        min: "0.0"
                        max: "11.624327937562668"
                        histogram:
                          - bin_start: 0
                            bin_end: 1.1624327937562668
                            count: 4
                          - bin_start: 1.1624327937562668
                            bin_end: 2.3248655875125337
                            count: 3
                          - bin_start: 2.3248655875125337
                            bin_end: 3.4872983812688005
                            count: 8
                          - bin_start: 3.4872983812688005
                            bin_end: 4.649731175025067
                            count: 6
                          - bin_start: 4.649731175025067
                            bin_end: 5.812163968781334
                            count: 2
                          - bin_start: 5.812163968781334
                            bin_end: 6.974596762537601
                            count: 4
                          - bin_start: 6.974596762537601
                            bin_end: 8.137029556293868
                            count: 3
                          - bin_start: 8.137029556293868
                            bin_end: 9.299462350050135
                            count: 0
                          - bin_start: 9.299462350050135
                            bin_end: 10.461895143806402
                            count: 1
                          - bin_start: 10.461895143806402
                            bin_end: 11.624327937562668
                            count: 4
                        categories: null
                    - name: cv
                      dtype: float64
                      stats:
                        unique_count: 33
                        nan_count: 0
                        min: "0.0"
                        max: "0.4773794679943672"
                        histogram:
                          - bin_start: 0
                            bin_end: 0.04773794679943672
                            count: 4
                          - bin_start: 0.04773794679943672
                            bin_end: 0.09547589359887344
                            count: 1
                          - bin_start: 0.09547589359887344
                            bin_end: 0.14321384039831017
                            count: 0
                          - bin_start: 0.14321384039831017
                            bin_end: 0.1909517871977469
                            count: 4
                          - bin_start: 0.1909517871977469
                            bin_end: 0.2386897339971836
                            count: 4
                          - bin_start: 0.2386897339971836
                            bin_end: 0.28642768079662034
                            count: 5
                          - bin_start: 0.28642768079662034
                            bin_end: 0.33416562759605706
                            count: 6
                          - bin_start: 0.33416562759605706
                            bin_end: 0.3819035743954938
                            count: 5
                          - bin_start: 0.3819035743954938
                            bin_end: 0.4296415211949305
                            count: 2
                          - bin_start: 0.4296415211949305
                            bin_end: 0.4773794679943672
                            count: 4
                        categories: null
                    - name: n_items
                      dtype: int64
                      stats:
                        unique_count: 22
                        nan_count: 0
                        min: "2"
                        max: "163"
                        histogram:
                          - bin_start: 2
                            bin_end: 18.1
                            count: 23
                          - bin_start: 18.1
                            bin_end: 34.2
                            count: 3
                          - bin_start: 34.2
                            bin_end: 50.300000000000004
                            count: 4
                          - bin_start: 50.300000000000004
                            bin_end: 66.4
                            count: 2
                          - bin_start: 66.4
                            bin_end: 82.5
                            count: 1
                          - bin_start: 82.5
                            bin_end: 98.60000000000001
                            count: 1
                          - bin_start: 98.60000000000001
                            bin_end: 114.70000000000002
                            count: 0
                          - bin_start: 114.70000000000002
                            bin_end: 130.8
                            count: 0
                          - bin_start: 130.8
                            bin_end: 146.9
                            count: 0
                          - bin_start: 146.9
                            bin_end: 163
                            count: 1
                        categories: null
                    - name: category
                      dtype: object
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Z
                            count: 21
                          - name: Y
                            count: 9
                          - name: X
                            count: 5
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 35
                  preview_row_count: 35
                  rows:
                    - brand: burt's bees
                      avg_price: 9.99
                      std_price: 0
                      cv: 0
                      n_items: 2
                      category: X
                      _deepnote_index_column: 0
                    - brand: essie
                      avg_price: 10
                      std_price: 0
                      cv: 0
                      n_items: 4
                      category: X
                      _deepnote_index_column: 1
                    - brand: moov
                      avg_price: 14.99
                      std_price: 0
                      cv: 0
                      n_items: 3
                      category: X
                      _deepnote_index_column: 2
                    - brand: deciem
                      avg_price: 6.800000000000001
                      std_price: 0.1414213562373093
                      cv: 0.020797258270192544
                      n_items: 2
                      category: X
                      _deepnote_index_column: 3
                    - brand: zorah
                      avg_price: 25.5
                      std_price: 2.1213203435596424
                      cv: 0.08318903308077029
                      n_items: 2
                      category: X
                      _deepnote_index_column: 4
                    - brand: annabelle
                      avg_price: 9.805454545454545
                      std_price: 1.4726259785591425
                      cv: 0.1501843664393711
                      n_items: 11
                      category: Y
                      _deepnote_index_column: 5
                    - brand: stila
                      avg_price: 46.2475
                      std_price: 7.088372521249148
                      cv: 0.1532703934536818
                      n_items: 4
                      category: Y
                      _deepnote_index_column: 6
                    - brand: sante
                      avg_price: 22.09
                      std_price: 3.750199994666951
                      cv: 0.16976912606007022
                      n_items: 6
                      category: Y
                      _deepnote_index_column: 7
                    - brand: glossier
                      avg_price: 25
                      std_price: 4.47213595499958
                      cv: 0.17888543819998318
                      n_items: 6
                      category: Y
                      _deepnote_index_column: 8
                    - brand: butter london
                      avg_price: 25.48
                      std_price: 4.9214631970583715
                      cv: 0.19315004698031285
                      n_items: 2
                      category: Y
                      _deepnote_index_column: 9
                  type: dataframe
                text/plain: |2-
                                   brand  avg_price  std_price        cv  n_items category
                  0          burt's bees   9.990000   0.000000  0.000000        2        X
                  1                essie  10.000000   0.000000  0.000000        4        X
                  2                 moov  14.990000   0.000000  0.000000        3        X
                  3               deciem   6.800000   0.141421  0.020797        2        X
                  4                zorah  25.500000   2.121320  0.083189        2        X
                  5            annabelle   9.805455   1.472626  0.150184       11        Y
                  6                stila  46.247500   7.088373  0.153270        4        Y
                  7                sante  22.090000   3.750200  0.169769        6        Y
                  8             glossier  25.000000   4.472136  0.178885        6        Y
                  9        butter london  25.480000   4.921463  0.193150        2        Y
                  10     cargo cosmetics  29.250000   6.264982  0.214187       20        Y
                  11        dr. hauschka  33.916667   7.668807  0.226107       12        Y
                  12               almay  12.661429   2.891746  0.228390       14        Y
                  13  physicians formula  17.213256   4.117433  0.239201       43        Y
                  14              milani   9.066923   2.396579  0.264321       13        Z
                  15            marcelle  14.590000   3.906039  0.267720       15        Z
                  16           covergirl   9.684444   2.608796  0.269380       54        Z
                  17               fenty  23.200000   6.610598  0.284940        5        Z
                  18            clinique  22.764674   6.524070  0.286587       92        Z
                  19                orly  10.745000   3.169653  0.294989        4        Z
                  20          maybelline  11.138148   3.290108  0.295391       54        Z
                  21              revlon  13.493448   4.063908  0.301176       29        Z
                  22                 nyx   8.469816   2.772462  0.327334      163        Z
                  23             l'oreal  13.871957   4.554460  0.328321       46        Z
                  24            anna sui  22.000000   7.563068  0.343776        6        Z
                  25             benefit  30.536585  10.587959  0.346730       41        Z
                  26                dior  28.514085  10.257044  0.359718       71        Z
                  27            smashbox  29.847826  10.776450  0.361046       46        Z
                  28          pure anada  14.249375   5.156000  0.361840       16        Z
                  29             suncoat  16.006667   6.163251  0.385043        6        Z
                  30              e.l.f.   6.767778   2.764241  0.408441       27        Z
                  31            pacifica  25.458462  11.570542  0.454487       13        Z
                  32      mineral fusion  25.375000  11.624328  0.458102        8        Z
                  33          wet n wild   4.306667   2.043541  0.474506       12        Z
                  34           colourpop   7.000000   3.341656  0.477379        4        Z
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>avg_price</th>
                        <th>std_price</th>
                        <th>cv</th>
                        <th>n_items</th>
                        <th>category</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>burt's bees</td>
                        <td>9.990000</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                        <td>2</td>
                        <td>X</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>essie</td>
                        <td>10.000000</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                        <td>4</td>
                        <td>X</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>moov</td>
                        <td>14.990000</td>
                        <td>0.000000</td>
                        <td>0.000000</td>
                        <td>3</td>
                        <td>X</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>deciem</td>
                        <td>6.800000</td>
                        <td>0.141421</td>
                        <td>0.020797</td>
                        <td>2</td>
                        <td>X</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>zorah</td>
                        <td>25.500000</td>
                        <td>2.121320</td>
                        <td>0.083189</td>
                        <td>2</td>
                        <td>X</td>
                      </tr>
                      <tr>
                        <th>5</th>
                        <td>annabelle</td>
                        <td>9.805455</td>
                        <td>1.472626</td>
                        <td>0.150184</td>
                        <td>11</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>6</th>
                        <td>stila</td>
                        <td>46.247500</td>
                        <td>7.088373</td>
                        <td>0.153270</td>
                        <td>4</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>7</th>
                        <td>sante</td>
                        <td>22.090000</td>
                        <td>3.750200</td>
                        <td>0.169769</td>
                        <td>6</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>8</th>
                        <td>glossier</td>
                        <td>25.000000</td>
                        <td>4.472136</td>
                        <td>0.178885</td>
                        <td>6</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>9</th>
                        <td>butter london</td>
                        <td>25.480000</td>
                        <td>4.921463</td>
                        <td>0.193150</td>
                        <td>2</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>10</th>
                        <td>cargo cosmetics</td>
                        <td>29.250000</td>
                        <td>6.264982</td>
                        <td>0.214187</td>
                        <td>20</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>11</th>
                        <td>dr. hauschka</td>
                        <td>33.916667</td>
                        <td>7.668807</td>
                        <td>0.226107</td>
                        <td>12</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>12</th>
                        <td>almay</td>
                        <td>12.661429</td>
                        <td>2.891746</td>
                        <td>0.228390</td>
                        <td>14</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>13</th>
                        <td>physicians formula</td>
                        <td>17.213256</td>
                        <td>4.117433</td>
                        <td>0.239201</td>
                        <td>43</td>
                        <td>Y</td>
                      </tr>
                      <tr>
                        <th>14</th>
                        <td>milani</td>
                        <td>9.066923</td>
                        <td>2.396579</td>
                        <td>0.264321</td>
                        <td>13</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>15</th>
                        <td>marcelle</td>
                        <td>14.590000</td>
                        <td>3.906039</td>
                        <td>0.267720</td>
                        <td>15</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>16</th>
                        <td>covergirl</td>
                        <td>9.684444</td>
                        <td>2.608796</td>
                        <td>0.269380</td>
                        <td>54</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>17</th>
                        <td>fenty</td>
                        <td>23.200000</td>
                        <td>6.610598</td>
                        <td>0.284940</td>
                        <td>5</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>18</th>
                        <td>clinique</td>
                        <td>22.764674</td>
                        <td>6.524070</td>
                        <td>0.286587</td>
                        <td>92</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>19</th>
                        <td>orly</td>
                        <td>10.745000</td>
                        <td>3.169653</td>
                        <td>0.294989</td>
                        <td>4</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>20</th>
                        <td>maybelline</td>
                        <td>11.138148</td>
                        <td>3.290108</td>
                        <td>0.295391</td>
                        <td>54</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>21</th>
                        <td>revlon</td>
                        <td>13.493448</td>
                        <td>4.063908</td>
                        <td>0.301176</td>
                        <td>29</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>22</th>
                        <td>nyx</td>
                        <td>8.469816</td>
                        <td>2.772462</td>
                        <td>0.327334</td>
                        <td>163</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>23</th>
                        <td>l'oreal</td>
                        <td>13.871957</td>
                        <td>4.554460</td>
                        <td>0.328321</td>
                        <td>46</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>24</th>
                        <td>anna sui</td>
                        <td>22.000000</td>
                        <td>7.563068</td>
                        <td>0.343776</td>
                        <td>6</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>25</th>
                        <td>benefit</td>
                        <td>30.536585</td>
                        <td>10.587959</td>
                        <td>0.346730</td>
                        <td>41</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>26</th>
                        <td>dior</td>
                        <td>28.514085</td>
                        <td>10.257044</td>
                        <td>0.359718</td>
                        <td>71</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>27</th>
                        <td>smashbox</td>
                        <td>29.847826</td>
                        <td>10.776450</td>
                        <td>0.361046</td>
                        <td>46</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>28</th>
                        <td>pure anada</td>
                        <td>14.249375</td>
                        <td>5.156000</td>
                        <td>0.361840</td>
                        <td>16</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>29</th>
                        <td>suncoat</td>
                        <td>16.006667</td>
                        <td>6.163251</td>
                        <td>0.385043</td>
                        <td>6</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>30</th>
                        <td>e.l.f.</td>
                        <td>6.767778</td>
                        <td>2.764241</td>
                        <td>0.408441</td>
                        <td>27</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>31</th>
                        <td>pacifica</td>
                        <td>25.458462</td>
                        <td>11.570542</td>
                        <td>0.454487</td>
                        <td>13</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>32</th>
                        <td>mineral fusion</td>
                        <td>25.375000</td>
                        <td>11.624328</td>
                        <td>0.458102</td>
                        <td>8</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>33</th>
                        <td>wet n wild</td>
                        <td>4.306667</td>
                        <td>2.043541</td>
                        <td>0.474506</td>
                        <td>12</td>
                        <td>Z</td>
                      </tr>
                      <tr>
                        <th>34</th>
                        <td>colourpop</td>
                        <td>7.000000</td>
                        <td>3.341656</td>
                        <td>0.477379</td>
                        <td>4</td>
                        <td>Z</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyy
          type: code
        - blockGroup: 6e2cc001ca984ea1af7a8f1194d4011f
          content: |
            import plotly.express as px

            fig = px.scatter(
                df_xyz,
                x="avg_price",
                y="cv",
                color="category",
                size="n_items",
                hover_name="brand",
                title="XYZ-анализ брендов (DuckDB)",
                labels={
                    "avg_price": "Средняя цена",
                    "cv": "Коэффициент вариации",
                    "category": "Категория XYZ",
                }
            )

            fig.update_layout(template="plotly_white")
            fig.show()
          executionCount: 13
          id: 900074db47c44b5a895202669a819d1b
          metadata:
            execution_start: 1763593438722
            execution_millis: 1780
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - data:
                text/html: |-
                  <html>
                  <head><meta charset="utf-8" /></head>
                  <body>
                      <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
                          <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.2.0.min.js" integrity="sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=" crossorigin="anonymous"></script>                <div id="11570234-2140-4540-ac5d-e534578682cc" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("11570234-2140-4540-ac5d-e534578682cc")) {                    Plotly.newPlot(                        "11570234-2140-4540-ac5d-e534578682cc",                        [{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003e\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f XYZ=X\u003cbr\u003e\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430=%{x}\u003cbr\u003e\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0438=%{y}\u003cbr\u003en_items=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["burt's bees","essie","moov","deciem","zorah"],"legendgroup":"X","marker":{"color":"#636efa","size":{"dtype":"i1","bdata":"AgQDAgI="},"sizemode":"area","sizeref":0.4075,"symbol":"circle"},"mode":"markers","name":"X","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"exSuR+H6I0AAAAAAAAAkQHsUrkfh+i1ANDMzMzMzG0AAAAAAAIA5QA=="},"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAx793YOBLlT\u002fPv3dg4Eu1Pw=="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003e\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f XYZ=Y\u003cbr\u003e\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430=%{x}\u003cbr\u003e\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0438=%{y}\u003cbr\u003en_items=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["annabelle","stila","sante","glossier","butter london","cargo cosmetics","dr. hauschka","almay","physicians formula"],"legendgroup":"Y","marker":{"color":"#EF553B","size":{"dtype":"i1","bdata":"CwQGBgIUDA4r"},"sizemode":"area","sizeref":0.4075,"symbol":"circle"},"mode":"markers","name":"Y","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"nEjGiWScI0BI4XoUrh9HQNejcD0KFzZAAAAAAAAAOUB7FK5H4Xo5QAAAAAAAQD1AVVVVVVX1QED42QXEplIpQLCc2u6XNjFA"},"xaxis":"x","y":{"dtype":"f8","bdata":"TiEdxz05wz8VEKo\u002fXZ7DP1g1Jqb+usU\u002f4Vdm0bflxj\u002fWKoAHJLnIP+Bcpk5+ass\u002fbkM22xXxzD\u002fQEZYN5DvNP1duJO8lns4\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003e\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f XYZ=Z\u003cbr\u003e\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430=%{x}\u003cbr\u003e\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0438=%{y}\u003cbr\u003en_items=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["milani","marcelle","covergirl","fenty","clinique","orly","maybelline","revlon","nyx","l'oreal","anna sui","benefit","dior","smashbox","pure anada","suncoat","e.l.f.","pacifica","mineral fusion","wet n wild","colourpop"],"legendgroup":"Z","marker":{"color":"#00cc96","size":{"dtype":"i2","bdata":"DQAPADYABQBcAAQANgAdAKMALgAGACkARwAuABAABgAbAA0ACAAMAAQA"},"sizemode":"area","sizeref":0.4075,"symbol":"circle"},"mode":"markers","name":"Z","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"8HbVvUMiIkCwR+F6FC4tQLeikYBvXiNAMzMzMzMzN0BIoGirwcM2QD4K16NwfSVAOZmkWrtGJkC+MJ5ApfwqQOauYLeL8CBAmM7QFXG+K0AAAAAAAAA2QInalahdiT5AcyDRCpuDPECGLGQhC9k9QEjhehSufyxAgU4b6LQBMEDAmnhWNBIbQIoqQrxddTlAAAAAAABgOUA7baDTBjoRQAAAAAAAABxA"},"xaxis":"x","y":{"dtype":"f8","bdata":"amnB5aLq0D\u002fgiNNaVCLRP2ByFNqFPdE\u002febPLF3M80j\u002fK4MzwclfSP1OfeQwY4dI\u002fiWVfOK\u002fn0j+RzcsxeUbTP9Sh5hgM89Q\u002fpl580jcD1T951eRRbADWP86HRz7UMNY\u002fvycGt6AF1z++bDxmYhvXP\u002fmhNN9kKNc\u002fhdiAcIqk2D9v3ftT5yPaPzQk+utQFt0\u002fExOwWIlR3T9im2VhUF7eP\u002fdUtJxijd4\u002f"},"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0438"}},"legend":{"title":{"text":"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f XYZ"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"XYZ-\u0430\u043d\u0430\u043b\u0438\u0437 \u0431\u0440\u0435\u043d\u0434\u043e\u0432 (DuckDB)"}},                        {"responsive": true}                    ).then(function(){
                                              
                  var gd = document.getElementById('11570234-2140-4540-ac5d-e534578682cc');
                  var x = new MutationObserver(function (mutations, observer) {{
                          var display = window.getComputedStyle(gd).display;
                          if (!display || display === 'none') {{
                              console.log([gd, 'removed!']);
                              Plotly.purge(gd);
                              observer.disconnect();
                          }}
                  }});

                  // Listen for the removal of the full notebook cells
                  var notebookContainer = gd.closest('#notebook-container');
                  if (notebookContainer) {{
                      x.observe(notebookContainer, {childList: true});
                  }}

                  // Listen for the clearing of the current output cell
                  var outputEl = gd.closest('.output');
                  if (outputEl) {{
                      x.observe(outputEl, {childList: true});
                  }}

                                          })                };            </script>        </div>
                  </body>
                  </html>
              metadata: {}
              output_type: display_data
          sortingKey: yyyU
          type: code
        - blockGroup: 723ea19a5f0342459bc38146c139b5d2
          content: |
            df_raw.columns
            df_raw.head()
          executionCount: 16
          id: de15a304b62c4803a93bbfae9fd270f1
          metadata:
            execution_start: 1763593530551
            execution_millis: 1
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 16
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 2
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 2
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: colourpop
                            count: 4
                          - name: boosh
                            count: 1
                    - name: price
                      dtype: float64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "5.0"
                        max: "26.0"
                        histogram:
                          - bin_start: 5
                            bin_end: 7.1
                            count: 3
                          - bin_start: 7.1
                            bin_end: 9.2
                            count: 0
                          - bin_start: 9.2
                            bin_end: 11.3
                            count: 0
                          - bin_start: 11.3
                            bin_end: 13.4
                            count: 1
                          - bin_start: 13.4
                            bin_end: 15.5
                            count: 0
                          - bin_start: 15.5
                            bin_end: 17.6
                            count: 0
                          - bin_start: 17.6
                            bin_end: 19.700000000000003
                            count: 0
                          - bin_start: 19.700000000000003
                            bin_end: 21.8
                            count: 0
                          - bin_start: 21.8
                            bin_end: 23.900000000000002
                            count: 0
                          - bin_start: 23.900000000000002
                            bin_end: 26
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: colourpop
                      price: 5
                      _deepnote_index_column: 0
                    - brand: colourpop
                      price: 5.5
                      _deepnote_index_column: 1
                    - brand: colourpop
                      price: 5.5
                      _deepnote_index_column: 2
                    - brand: colourpop
                      price: 12
                      _deepnote_index_column: 3
                    - brand: boosh
                      price: 26
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                         brand  price
                  0  colourpop    5.0
                  1  colourpop    5.5
                  2  colourpop    5.5
                  3  colourpop   12.0
                  4      boosh   26.0
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>price</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>colourpop</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>colourpop</td>
                        <td>5.5</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>colourpop</td>
                        <td>5.5</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>colourpop</td>
                        <td>12.0</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>boosh</td>
                        <td>26.0</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyyj
          type: code
        - blockGroup: 4374fc086d2c4b80b4a5c53121d4f391
          content: |
            con.register("raw_data", df_raw)
          executionCount: 19
          id: 4fd2dc57799e487e817bb3b55da6565c
          metadata:
            execution_start: 1763593576101
            execution_millis: 1
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 19
              data:
                text/plain: <_duckdb.DuckDBPyConnection at 0x7fc16274f1b0>
              metadata: {}
          sortingKey: yyyr
          type: code
        - blockGroup: 9f494f075fb542a4bb589df45d37f12c
          content: >-
            R → Richness (разнообразие ассортимента бренда)

            Количество товаров бренда

            → COUNT(price)

            F → Frequency (частота встречаемости бренда в каталоге)

            То же самое, но измеряется иначе:

            → Доля бренда в общем количестве товаров

            COUNT(price) / SUM(COUNT(price))

            M → Monetary (средний ценовой уровень)

            → AVG(price)

            Это валидная адаптация под каталог и отлично подходит под анализ
            брендов.
          id: c4fa79ccdbd64aabbfd20ddd71144ad5
          metadata:
            formattedRanges: []
          sortingKey: yyyt
          type: text-cell-p
        - blockGroup: 0240e840ed3a4e28847569aad35c5cd0
          content: >
            query_rfm = """

            SELECT
                brand,
                COUNT(*) AS R,                              -- richness
                COUNT(*) * 1.0 / (SELECT COUNT(*) FROM raw_data) AS F,   -- frequency share
                AVG(price) AS M                             -- monetary
            FROM raw_data

            GROUP BY brand

            ORDER BY M DESC;

            """


            df_rfm = con.execute(query_rfm).df()

            df_rfm.head()
          executionCount: 22
          id: 8c96f2ca452e4cf0b2f7f1e0a33db253
          metadata:
            execution_start: 1763593582379
            execution_millis: 11
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 22
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 4
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: mistura
                            count: 1
                          - name: stila
                            count: 1
                          - name: 3 others
                            count: 3
                    - name: R
                      dtype: int64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "1"
                        max: "46"
                        histogram:
                          - bin_start: 1
                            bin_end: 5.5
                            count: 2
                          - bin_start: 5.5
                            bin_end: 10
                            count: 0
                          - bin_start: 10
                            bin_end: 14.5
                            count: 1
                          - bin_start: 14.5
                            bin_end: 19
                            count: 0
                          - bin_start: 19
                            bin_end: 23.5
                            count: 0
                          - bin_start: 23.5
                            bin_end: 28
                            count: 0
                          - bin_start: 28
                            bin_end: 32.5
                            count: 0
                          - bin_start: 32.5
                            bin_end: 37
                            count: 0
                          - bin_start: 37
                            bin_end: 41.5
                            count: 1
                          - bin_start: 41.5
                            bin_end: 46
                            count: 1
                        categories: null
                    - name: F
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "0.0011560693641618498"
                        max: "0.05317919075144509"
                        histogram:
                          - bin_start: 0.0011560693641618498
                            bin_end: 0.006358381502890174
                            count: 2
                          - bin_start: 0.006358381502890174
                            bin_end: 0.011560693641618497
                            count: 0
                          - bin_start: 0.011560693641618497
                            bin_end: 0.01676300578034682
                            count: 1
                          - bin_start: 0.01676300578034682
                            bin_end: 0.021965317919075144
                            count: 0
                          - bin_start: 0.021965317919075144
                            bin_end: 0.02716763005780347
                            count: 0
                          - bin_start: 0.02716763005780347
                            bin_end: 0.03236994219653179
                            count: 0
                          - bin_start: 0.03236994219653179
                            bin_end: 0.03757225433526012
                            count: 0
                          - bin_start: 0.03757225433526012
                            bin_end: 0.04277456647398844
                            count: 0
                          - bin_start: 0.04277456647398844
                            bin_end: 0.04797687861271676
                            count: 1
                          - bin_start: 0.04797687861271676
                            bin_end: 0.05317919075144509
                            count: 1
                        categories: null
                    - name: M
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "29.847826086956523"
                        max: "56.49"
                        histogram:
                          - bin_start: 29.847826086956523
                            bin_end: 32.51204347826087
                            count: 2
                          - bin_start: 32.51204347826087
                            bin_end: 35.17626086956522
                            count: 1
                          - bin_start: 35.17626086956522
                            bin_end: 37.84047826086957
                            count: 0
                          - bin_start: 37.84047826086957
                            bin_end: 40.504695652173915
                            count: 0
                          - bin_start: 40.504695652173915
                            bin_end: 43.16891304347826
                            count: 0
                          - bin_start: 43.16891304347826
                            bin_end: 45.83313043478261
                            count: 0
                          - bin_start: 45.83313043478261
                            bin_end: 48.49734782608696
                            count: 1
                          - bin_start: 48.49734782608696
                            bin_end: 51.161565217391306
                            count: 0
                          - bin_start: 51.161565217391306
                            bin_end: 53.825782608695654
                            count: 0
                          - bin_start: 53.825782608695654
                            bin_end: 56.49
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: mistura
                      R: 1
                      F: 0.0011560693641618498
                      M: 56.49
                      _deepnote_index_column: 0
                    - brand: stila
                      R: 4
                      F: 0.004624277456647399
                      M: 46.2475
                      _deepnote_index_column: 1
                    - brand: dr. hauschka
                      R: 12
                      F: 0.013872832369942197
                      M: 33.916666666666664
                      _deepnote_index_column: 2
                    - brand: benefit
                      R: 41
                      F: 0.047398843930635835
                      M: 30.536585365853657
                      _deepnote_index_column: 3
                    - brand: smashbox
                      R: 46
                      F: 0.05317919075144509
                      M: 29.847826086956523
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                            brand   R         F          M
                  0       mistura   1  0.001156  56.490000
                  1         stila   4  0.004624  46.247500
                  2  dr. hauschka  12  0.013873  33.916667
                  3       benefit  41  0.047399  30.536585
                  4      smashbox  46  0.053179  29.847826
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>R</th>
                        <th>F</th>
                        <th>M</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>mistura</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>56.490000</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>stila</td>
                        <td>4</td>
                        <td>0.004624</td>
                        <td>46.247500</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>dr. hauschka</td>
                        <td>12</td>
                        <td>0.013873</td>
                        <td>33.916667</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>benefit</td>
                        <td>41</td>
                        <td>0.047399</td>
                        <td>30.536585</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>smashbox</td>
                        <td>46</td>
                        <td>0.053179</td>
                        <td>29.847826</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyyv
          type: code
        - blockGroup: c4fb46fada984e568ca6e6d01763bcdb
          content: >
            import pandas as pd


            df_rfm["R_score"] = pd.qcut(df_rfm["R"], 3, labels=[1,2,3])

            df_rfm["F_score"] = pd.qcut(df_rfm["F"], 3, labels=[1,2,3])

            df_rfm["M_score"] = pd.qcut(df_rfm["M"], 3, labels=[1,2,3])


            df_rfm["RFM"] = df_rfm["R_score"].astype(str) +
            df_rfm["F_score"].astype(str) + df_rfm["M_score"].astype(str)


            df_rfm
          executionCount: 25
          id: 363b982307124d13a670a48a4d410fc2
          metadata:
            execution_start: 1763593595173
            execution_millis: 18
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 25
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 8
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 44
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: mistura
                            count: 1
                          - name: stila
                            count: 1
                          - name: 42 others
                            count: 42
                    - name: R
                      dtype: int64
                      stats:
                        unique_count: 23
                        nan_count: 0
                        min: "1"
                        max: "163"
                        histogram:
                          - bin_start: 1
                            bin_end: 17.2
                            count: 32
                          - bin_start: 17.2
                            bin_end: 33.4
                            count: 3
                          - bin_start: 33.4
                            bin_end: 49.599999999999994
                            count: 4
                          - bin_start: 49.599999999999994
                            bin_end: 65.8
                            count: 2
                          - bin_start: 65.8
                            bin_end: 82
                            count: 1
                          - bin_start: 82
                            bin_end: 98.19999999999999
                            count: 1
                          - bin_start: 98.19999999999999
                            bin_end: 114.39999999999999
                            count: 0
                          - bin_start: 114.39999999999999
                            bin_end: 130.6
                            count: 0
                          - bin_start: 130.6
                            bin_end: 146.79999999999998
                            count: 0
                          - bin_start: 146.79999999999998
                            bin_end: 163
                            count: 1
                        categories: null
                    - name: F
                      dtype: float64
                      stats:
                        unique_count: 23
                        nan_count: 0
                        min: "0.0011560693641618498"
                        max: "0.1884393063583815"
                        histogram:
                          - bin_start: 0.0011560693641618498
                            bin_end: 0.019884393063583812
                            count: 32
                          - bin_start: 0.019884393063583812
                            bin_end: 0.038612716763005775
                            count: 3
                          - bin_start: 0.038612716763005775
                            bin_end: 0.05734104046242774
                            count: 4
                          - bin_start: 0.05734104046242774
                            bin_end: 0.0760693641618497
                            count: 2
                          - bin_start: 0.0760693641618497
                            bin_end: 0.09479768786127166
                            count: 1
                          - bin_start: 0.09479768786127166
                            bin_end: 0.11352601156069363
                            count: 1
                          - bin_start: 0.11352601156069363
                            bin_end: 0.1322543352601156
                            count: 0
                          - bin_start: 0.1322543352601156
                            bin_end: 0.15098265895953755
                            count: 0
                          - bin_start: 0.15098265895953755
                            bin_end: 0.1697109826589595
                            count: 0
                          - bin_start: 0.1697109826589595
                            bin_end: 0.1884393063583815
                            count: 1
                        categories: null
                    - name: M
                      dtype: float64
                      stats:
                        unique_count: 43
                        nan_count: 0
                        min: "2.99"
                        max: "56.49"
                        histogram:
                          - bin_start: 2.99
                            bin_end: 8.34
                            count: 7
                          - bin_start: 8.34
                            bin_end: 13.69
                            count: 13
                          - bin_start: 13.69
                            bin_end: 19.04
                            count: 6
                          - bin_start: 19.04
                            bin_end: 24.39
                            count: 5
                          - bin_start: 24.39
                            bin_end: 29.740000000000002
                            count: 8
                          - bin_start: 29.740000000000002
                            bin_end: 35.089999999999996
                            count: 3
                          - bin_start: 35.089999999999996
                            bin_end: 40.44
                            count: 0
                          - bin_start: 40.44
                            bin_end: 45.79
                            count: 0
                          - bin_start: 45.79
                            bin_end: 51.14
                            count: 1
                          - bin_start: 51.14
                            bin_end: 56.49
                            count: 1
                        categories: null
                    - name: R_score
                      dtype: category
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: "1"
                            count: 18
                          - name: "3"
                            count: 15
                          - name: "2"
                            count: 11
                    - name: F_score
                      dtype: category
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: "1"
                            count: 18
                          - name: "3"
                            count: 15
                          - name: "2"
                            count: 11
                    - name: M_score
                      dtype: category
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: "3"
                            count: 15
                          - name: "1"
                            count: 15
                          - name: "2"
                            count: 14
                    - name: RFM
                      dtype: object
                      stats:
                        unique_count: 9
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: "111"
                            count: 9
                          - name: "332"
                            count: 7
                          - name: 7 others
                            count: 28
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 44
                  preview_row_count: 44
                  rows:
                    - brand: mistura
                      R: 1
                      F: 0.0011560693641618498
                      M: 56.49
                      R_score: "1"
                      F_score: "1"
                      M_score: "3"
                      RFM: "113"
                      _deepnote_index_column: 0
                    - brand: stila
                      R: 4
                      F: 0.004624277456647399
                      M: 46.2475
                      R_score: "1"
                      F_score: "1"
                      M_score: "3"
                      RFM: "113"
                      _deepnote_index_column: 1
                    - brand: dr. hauschka
                      R: 12
                      F: 0.013872832369942197
                      M: 33.916666666666664
                      R_score: "2"
                      F_score: "2"
                      M_score: "3"
                      RFM: "223"
                      _deepnote_index_column: 2
                    - brand: benefit
                      R: 41
                      F: 0.047398843930635835
                      M: 30.536585365853657
                      R_score: "3"
                      F_score: "3"
                      M_score: "3"
                      RFM: "333"
                      _deepnote_index_column: 3
                    - brand: smashbox
                      R: 46
                      F: 0.05317919075144509
                      M: 29.847826086956523
                      R_score: "3"
                      F_score: "3"
                      M_score: "3"
                      RFM: "333"
                      _deepnote_index_column: 4
                    - brand: cargo cosmetics
                      R: 20
                      F: 0.023121387283236993
                      M: 29.25
                      R_score: "3"
                      F_score: "3"
                      M_score: "3"
                      RFM: "333"
                      _deepnote_index_column: 5
                    - brand: dior
                      R: 71
                      F: 0.08208092485549133
                      M: 28.514084507042252
                      R_score: "3"
                      F_score: "3"
                      M_score: "3"
                      RFM: "333"
                      _deepnote_index_column: 6
                    - brand: boosh
                      R: 1
                      F: 0.0011560693641618498
                      M: 26
                      R_score: "1"
                      F_score: "1"
                      M_score: "3"
                      RFM: "113"
                      _deepnote_index_column: 7
                    - brand: zorah
                      R: 2
                      F: 0.0023121387283236996
                      M: 25.5
                      R_score: "1"
                      F_score: "1"
                      M_score: "3"
                      RFM: "113"
                      _deepnote_index_column: 8
                    - brand: butter london
                      R: 2
                      F: 0.0023121387283236996
                      M: 25.48
                      R_score: "1"
                      F_score: "1"
                      M_score: "3"
                      RFM: "113"
                      _deepnote_index_column: 9
                  type: dataframe
                text/plain: |2-
                                   brand    R         F          M R_score F_score M_score  RFM
                  0              mistura    1  0.001156  56.490000       1       1       3  113
                  1                stila    4  0.004624  46.247500       1       1       3  113
                  2         dr. hauschka   12  0.013873  33.916667       2       2       3  223
                  3              benefit   41  0.047399  30.536585       3       3       3  333
                  4             smashbox   46  0.053179  29.847826       3       3       3  333
                  5      cargo cosmetics   20  0.023121  29.250000       3       3       3  333
                  6                 dior   71  0.082081  28.514085       3       3       3  333
                  7                boosh    1  0.001156  26.000000       1       1       3  113
                  8                zorah    2  0.002312  25.500000       1       1       3  113
                  9        butter london    2  0.002312  25.480000       1       1       3  113
                  10            pacifica   13  0.015029  25.458462       2       2       3  223
                  11      mineral fusion    8  0.009249  25.375000       2       2       3  223
                  12            glossier    6  0.006936  25.000000       2       2       3  223
                  13               fenty    5  0.005780  23.200000       2       2       3  223
                  14            clinique   92  0.106358  22.764674       3       3       3  333
                  15               sante    6  0.006936  22.090000       2       2       2  222
                  16            anna sui    6  0.006936  22.000000       2       2       2  222
                  17              dalish    1  0.001156  22.000000       1       1       2  112
                  18  physicians formula   43  0.049711  17.213256       3       3       2  332
                  19             suncoat    6  0.006936  16.006667       2       2       2  222
                  20                moov    3  0.003468  14.990000       1       1       2  112
                  21            marcelle   15  0.017341  14.590000       3       3       2  332
                  22          pure anada   16  0.018497  14.249375       3       3       2  332
                  23             l'oreal   46  0.053179  13.871957       3       3       2  332
                  24              revlon   29  0.033526  13.493448       3       3       2  332
                  25               almay   14  0.016185  12.661429       3       3       2  332
                  26         piggy paint    1  0.001156  11.990000       1       1       2  112
                  27          maybelline   54  0.062428  11.138148       3       3       2  332
                  28                orly    4  0.004624  10.745000       1       1       2  112
                  29               essie    4  0.004624  10.000000       1       1       1  111
                  30         burt's bees    2  0.002312   9.990000       1       1       1  111
                  31                alva    1  0.001156   9.950000       1       1       1  111
                  32           annabelle   11  0.012717   9.805455       2       2       1  221
                  33           covergirl   54  0.062428   9.684444       3       3       1  331
                  34                misa    1  0.001156   9.390000       1       1       1  111
                  35              milani   13  0.015029   9.066923       2       2       1  221
                  36                 nyx  163  0.188439   8.469816       3       3       1  331
                  37         china glaze    1  0.001156   8.000000       1       1       1  111
                  38           colourpop    4  0.004624   7.000000       1       1       1  111
                  39       salon perfect    1  0.001156   6.990000       1       1       1  111
                  40              deciem    2  0.002312   6.800000       1       1       1  111
                  41              e.l.f.   27  0.031214   6.767778       3       3       1  331
                  42          wet n wild   12  0.013873   4.306667       2       2       1  221
                  43      sinful colours    1  0.001156   2.990000       1       1       1  111
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>R</th>
                        <th>F</th>
                        <th>M</th>
                        <th>R_score</th>
                        <th>F_score</th>
                        <th>M_score</th>
                        <th>RFM</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>mistura</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>56.490000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>3</td>
                        <td>113</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>stila</td>
                        <td>4</td>
                        <td>0.004624</td>
                        <td>46.247500</td>
                        <td>1</td>
                        <td>1</td>
                        <td>3</td>
                        <td>113</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>dr. hauschka</td>
                        <td>12</td>
                        <td>0.013873</td>
                        <td>33.916667</td>
                        <td>2</td>
                        <td>2</td>
                        <td>3</td>
                        <td>223</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>benefit</td>
                        <td>41</td>
                        <td>0.047399</td>
                        <td>30.536585</td>
                        <td>3</td>
                        <td>3</td>
                        <td>3</td>
                        <td>333</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>smashbox</td>
                        <td>46</td>
                        <td>0.053179</td>
                        <td>29.847826</td>
                        <td>3</td>
                        <td>3</td>
                        <td>3</td>
                        <td>333</td>
                      </tr>
                      <tr>
                        <th>5</th>
                        <td>cargo cosmetics</td>
                        <td>20</td>
                        <td>0.023121</td>
                        <td>29.250000</td>
                        <td>3</td>
                        <td>3</td>
                        <td>3</td>
                        <td>333</td>
                      </tr>
                      <tr>
                        <th>6</th>
                        <td>dior</td>
                        <td>71</td>
                        <td>0.082081</td>
                        <td>28.514085</td>
                        <td>3</td>
                        <td>3</td>
                        <td>3</td>
                        <td>333</td>
                      </tr>
                      <tr>
                        <th>7</th>
                        <td>boosh</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>26.000000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>3</td>
                        <td>113</td>
                      </tr>
                      <tr>
                        <th>8</th>
                        <td>zorah</td>
                        <td>2</td>
                        <td>0.002312</td>
                        <td>25.500000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>3</td>
                        <td>113</td>
                      </tr>
                      <tr>
                        <th>9</th>
                        <td>butter london</td>
                        <td>2</td>
                        <td>0.002312</td>
                        <td>25.480000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>3</td>
                        <td>113</td>
                      </tr>
                      <tr>
                        <th>10</th>
                        <td>pacifica</td>
                        <td>13</td>
                        <td>0.015029</td>
                        <td>25.458462</td>
                        <td>2</td>
                        <td>2</td>
                        <td>3</td>
                        <td>223</td>
                      </tr>
                      <tr>
                        <th>11</th>
                        <td>mineral fusion</td>
                        <td>8</td>
                        <td>0.009249</td>
                        <td>25.375000</td>
                        <td>2</td>
                        <td>2</td>
                        <td>3</td>
                        <td>223</td>
                      </tr>
                      <tr>
                        <th>12</th>
                        <td>glossier</td>
                        <td>6</td>
                        <td>0.006936</td>
                        <td>25.000000</td>
                        <td>2</td>
                        <td>2</td>
                        <td>3</td>
                        <td>223</td>
                      </tr>
                      <tr>
                        <th>13</th>
                        <td>fenty</td>
                        <td>5</td>
                        <td>0.005780</td>
                        <td>23.200000</td>
                        <td>2</td>
                        <td>2</td>
                        <td>3</td>
                        <td>223</td>
                      </tr>
                      <tr>
                        <th>14</th>
                        <td>clinique</td>
                        <td>92</td>
                        <td>0.106358</td>
                        <td>22.764674</td>
                        <td>3</td>
                        <td>3</td>
                        <td>3</td>
                        <td>333</td>
                      </tr>
                      <tr>
                        <th>15</th>
                        <td>sante</td>
                        <td>6</td>
                        <td>0.006936</td>
                        <td>22.090000</td>
                        <td>2</td>
                        <td>2</td>
                        <td>2</td>
                        <td>222</td>
                      </tr>
                      <tr>
                        <th>16</th>
                        <td>anna sui</td>
                        <td>6</td>
                        <td>0.006936</td>
                        <td>22.000000</td>
                        <td>2</td>
                        <td>2</td>
                        <td>2</td>
                        <td>222</td>
                      </tr>
                      <tr>
                        <th>17</th>
                        <td>dalish</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>22.000000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>112</td>
                      </tr>
                      <tr>
                        <th>18</th>
                        <td>physicians formula</td>
                        <td>43</td>
                        <td>0.049711</td>
                        <td>17.213256</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>19</th>
                        <td>suncoat</td>
                        <td>6</td>
                        <td>0.006936</td>
                        <td>16.006667</td>
                        <td>2</td>
                        <td>2</td>
                        <td>2</td>
                        <td>222</td>
                      </tr>
                      <tr>
                        <th>20</th>
                        <td>moov</td>
                        <td>3</td>
                        <td>0.003468</td>
                        <td>14.990000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>112</td>
                      </tr>
                      <tr>
                        <th>21</th>
                        <td>marcelle</td>
                        <td>15</td>
                        <td>0.017341</td>
                        <td>14.590000</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>22</th>
                        <td>pure anada</td>
                        <td>16</td>
                        <td>0.018497</td>
                        <td>14.249375</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>23</th>
                        <td>l'oreal</td>
                        <td>46</td>
                        <td>0.053179</td>
                        <td>13.871957</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>24</th>
                        <td>revlon</td>
                        <td>29</td>
                        <td>0.033526</td>
                        <td>13.493448</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>25</th>
                        <td>almay</td>
                        <td>14</td>
                        <td>0.016185</td>
                        <td>12.661429</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>26</th>
                        <td>piggy paint</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>11.990000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>112</td>
                      </tr>
                      <tr>
                        <th>27</th>
                        <td>maybelline</td>
                        <td>54</td>
                        <td>0.062428</td>
                        <td>11.138148</td>
                        <td>3</td>
                        <td>3</td>
                        <td>2</td>
                        <td>332</td>
                      </tr>
                      <tr>
                        <th>28</th>
                        <td>orly</td>
                        <td>4</td>
                        <td>0.004624</td>
                        <td>10.745000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>112</td>
                      </tr>
                      <tr>
                        <th>29</th>
                        <td>essie</td>
                        <td>4</td>
                        <td>0.004624</td>
                        <td>10.000000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>30</th>
                        <td>burt's bees</td>
                        <td>2</td>
                        <td>0.002312</td>
                        <td>9.990000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>31</th>
                        <td>alva</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>9.950000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>32</th>
                        <td>annabelle</td>
                        <td>11</td>
                        <td>0.012717</td>
                        <td>9.805455</td>
                        <td>2</td>
                        <td>2</td>
                        <td>1</td>
                        <td>221</td>
                      </tr>
                      <tr>
                        <th>33</th>
                        <td>covergirl</td>
                        <td>54</td>
                        <td>0.062428</td>
                        <td>9.684444</td>
                        <td>3</td>
                        <td>3</td>
                        <td>1</td>
                        <td>331</td>
                      </tr>
                      <tr>
                        <th>34</th>
                        <td>misa</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>9.390000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>35</th>
                        <td>milani</td>
                        <td>13</td>
                        <td>0.015029</td>
                        <td>9.066923</td>
                        <td>2</td>
                        <td>2</td>
                        <td>1</td>
                        <td>221</td>
                      </tr>
                      <tr>
                        <th>36</th>
                        <td>nyx</td>
                        <td>163</td>
                        <td>0.188439</td>
                        <td>8.469816</td>
                        <td>3</td>
                        <td>3</td>
                        <td>1</td>
                        <td>331</td>
                      </tr>
                      <tr>
                        <th>37</th>
                        <td>china glaze</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>8.000000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>38</th>
                        <td>colourpop</td>
                        <td>4</td>
                        <td>0.004624</td>
                        <td>7.000000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>39</th>
                        <td>salon perfect</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>6.990000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>40</th>
                        <td>deciem</td>
                        <td>2</td>
                        <td>0.002312</td>
                        <td>6.800000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                      <tr>
                        <th>41</th>
                        <td>e.l.f.</td>
                        <td>27</td>
                        <td>0.031214</td>
                        <td>6.767778</td>
                        <td>3</td>
                        <td>3</td>
                        <td>1</td>
                        <td>331</td>
                      </tr>
                      <tr>
                        <th>42</th>
                        <td>wet n wild</td>
                        <td>12</td>
                        <td>0.013873</td>
                        <td>4.306667</td>
                        <td>2</td>
                        <td>2</td>
                        <td>1</td>
                        <td>221</td>
                      </tr>
                      <tr>
                        <th>43</th>
                        <td>sinful colours</td>
                        <td>1</td>
                        <td>0.001156</td>
                        <td>2.990000</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td>111</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyyx
          type: code
        - blockGroup: a1427722254043939cd21cdc21daeb23
          content: |-
            Теперь у брендов есть RFM-код, например:
            333 — элитные сильные бренды
            111 — слабая дешёвая группа
            132 — дорогой, но редкий бренд
          id: 8848c34025d5425299078bbc247114c3
          metadata:
            formattedRanges: []
          sortingKey: yyyy
          type: text-cell-p
        - blockGroup: ec8709de03f14438adda55b2f90a013a
          content: |
            import plotly.express as px

            fig = px.scatter(
                df_rfm,
                x="R",
                y="M",
                size="F",
                color="RFM",
                hover_name="brand",
                title="RFM-анализ брендов (адаптированный)"
            )

            fig.update_layout(template="plotly_white")
            fig.show()
          executionCount: 28
          id: 9d06fcc5b8bc42929095b9709836badd
          metadata:
            execution_start: 1763593613391
            execution_millis: 4
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - data:
                text/html: |-
                  <html>
                  <head><meta charset="utf-8" /></head>
                  <body>
                      <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
                          <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.2.0.min.js" integrity="sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=" crossorigin="anonymous"></script>                <div id="2a517a83-1d9f-4347-ac94-1331b0b0c636" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("2a517a83-1d9f-4347-ac94-1331b0b0c636")) {                    Plotly.newPlot(                        "2a517a83-1d9f-4347-ac94-1331b0b0c636",                        [{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=113\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["mistura","stila","boosh","zorah","butter london"],"legendgroup":"113","marker":{"color":"#636efa","size":{"dtype":"f8","bdata":"A1caB+jwUj8DVxoH6PByPwNXGgfo8FI\u002fA1caB+jwYj8DVxoH6PBiPw=="},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"113","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"AQQBAgI="},"xaxis":"x","y":{"dtype":"f8","bdata":"H4XrUbg+TEBI4XoUrh9HQAAAAAAAADpAAAAAAACAOUB7FK5H4Xo5QA=="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=223\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["dr. hauschka","pacifica","mineral fusion","glossier","fenty"],"legendgroup":"223","marker":{"color":"#EF553B","size":{"dtype":"f8","bdata":"hIKnClxpjD9kzYoLeceOPwNXGgfo8II\u002fhIKnClxpfD\u002fD7OAIIq13Pw=="},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"223","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"DA0IBgU="},"xaxis":"x","y":{"dtype":"f8","bdata":"VVVVVVX1QECKKkK8XXU5QAAAAAAAYDlAAAAAAAAAOUAzMzMzMzM3QA=="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=333\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["benefit","smashbox","cargo cosmetics","dior","clinique"],"legendgroup":"333","marker":{"color":"#00cc96","size":{"dtype":"f8","bdata":"e78ZSalEqD8U3TWKTTqrP8Ps4AgirZc\u002fhzjhZ0EDtT8U3TWKTTq7Pw=="},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"333","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"KS4UR1w="},"xaxis":"x","y":{"dtype":"f8","bdata":"idqVqF2JPkCGLGQhC9k9QAAAAAAAQD1AcyDRCpuDPEBIoGirwcM2QA=="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=222\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["sante","anna sui","suncoat"],"legendgroup":"222","marker":{"color":"#ab63fa","size":{"dtype":"f8","bdata":"hIKnClxpfD+EgqcKXGl8P4SCpwpcaXw\u002f"},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"222","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"BgYG"},"xaxis":"x","y":{"dtype":"f8","bdata":"16NwPQoXNkAAAAAAAAA2QIFOG+i0ATBA"},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=112\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["dalish","moov","piggy paint","orly"],"legendgroup":"112","marker":{"color":"#FFA15A","size":{"dtype":"f8","bdata":"A1caB+jwUj+EgqcKXGlsPwNXGgfo8FI\u002fA1caB+jwcj8="},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"112","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"AQMBBA=="},"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAANkB7FK5H4fotQHsUrkfh+idAPgrXo3B9JUA="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=332\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["physicians formula","marcelle","pure anada","l'oreal","revlon","almay","maybelline"],"legendgroup":"332","marker":{"color":"#19d3f3","size":{"dtype":"f8","bdata":"7GSLybdzqT+SsaiG2cGRPwNXGgfo8JI\u002fFN01ik06qz\u002fa3m9GUiqhPyIMNwbLkpA\u002f1HL8i4f2rz8="},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"332","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"Kw8QLh0ONg=="},"xaxis":"x","y":{"dtype":"f8","bdata":"sJza7pc2MUCwR+F6FC4tQEjhehSufyxAmM7QFXG+K0C+MJ5ApfwqQPjZBcSmUilAOZmkWrtGJkA="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=111\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["essie","burt's bees","alva","misa","china glaze","colourpop","salon perfect","deciem","sinful colours"],"legendgroup":"111","marker":{"color":"#FF6692","size":{"dtype":"f8","bdata":"A1caB+jwcj8DVxoH6PBiPwNXGgfo8FI\u002fA1caB+jwUj8DVxoH6PBSPwNXGgfo8HI\u002fA1caB+jwUj8DVxoH6PBiPwNXGgfo8FI\u002f"},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"111","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"BAIBAQEEAQIB"},"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAAJEB7FK5H4fojQGZmZmZm5iNASOF6FK7HIkAAAAAAAAAgQAAAAAAAABxA9ihcj8L1G0A0MzMzMzMbQOxRuB6F6wdA"},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=221\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["annabelle","milani","wet n wild"],"legendgroup":"221","marker":{"color":"#B6E880","size":{"dtype":"f8","bdata":"pDfECT8Lij9kzYoLeceOP4SCpwpcaYw\u002f"},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"221","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"Cw0M"},"xaxis":"x","y":{"dtype":"f8","bdata":"nEjGiWScI0DwdtW9QyIiQDttoNMGOhFA"},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=331\u003cbr\u003eR=%{x}\u003cbr\u003eM=%{y}\u003cbr\u003eF=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["covergirl","nyx","e.l.f."],"legendgroup":"331","marker":{"color":"#FF97FF","size":{"dtype":"f8","bdata":"1HL8i4f2rz\u002fNigt5xx7IP9Ry\u002fIuH9p8\u002f"},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"331","orientation":"v","showlegend":true,"x":{"dtype":"i2","bdata":"NgCjABsA"},"xaxis":"x","y":{"dtype":"f8","bdata":"t6KRgG9eI0DmrmC3i\u002fAgQMCaeFY0EhtA"},"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"R"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"M"}},"legend":{"title":{"text":"RFM"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"RFM-\u0430\u043d\u0430\u043b\u0438\u0437 \u0431\u0440\u0435\u043d\u0434\u043e\u0432 (\u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439)"}},                        {"responsive": true}                    ).then(function(){
                                              
                  var gd = document.getElementById('2a517a83-1d9f-4347-ac94-1331b0b0c636');
                  var x = new MutationObserver(function (mutations, observer) {{
                          var display = window.getComputedStyle(gd).display;
                          if (!display || display === 'none') {{
                              console.log([gd, 'removed!']);
                              Plotly.purge(gd);
                              observer.disconnect();
                          }}
                  }});

                  // Listen for the removal of the full notebook cells
                  var notebookContainer = gd.closest('#notebook-container');
                  if (notebookContainer) {{
                      x.observe(notebookContainer, {childList: true});
                  }}

                  // Listen for the clearing of the current output cell
                  var outputEl = gd.closest('.output');
                  if (outputEl) {{
                      x.observe(outputEl, {childList: true});
                  }}

                                          })                };            </script>        </div>
                  </body>
                  </html>
              metadata: {}
              output_type: display_data
          sortingKey: yyyyU
          type: code
        - blockGroup: de6fee0d076645099b72713a006b82bf
          content: |
            import plotly.express as px

            fig = px.density_heatmap(
                df_rfm,
                x="R",
                y="M",
                z="F",
                histfunc="avg",
                color_continuous_scale="Bluered",
                title="RFM Heatmap: интенсивность брендов",
                labels={"R": "Richness (кол-во товаров)", "M": "Average price"}
            )
            fig.show()
          executionCount: 31
          id: a082ba37251144ae95a8972e18059fdb
          metadata:
            execution_start: 1763593652441
            execution_millis: 59
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - data:
                text/html: |-
                  <html>
                  <head><meta charset="utf-8" /></head>
                  <body>
                      <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
                          <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.2.0.min.js" integrity="sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=" crossorigin="anonymous"></script>                <div id="a0a898e7-ba98-4ebb-90b2-9152eb5b12b5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("a0a898e7-ba98-4ebb-90b2-9152eb5b12b5")) {                    Plotly.newPlot(                        "a0a898e7-ba98-4ebb-90b2-9152eb5b12b5",                        [{"coloraxis":"coloraxis","histfunc":"avg","hovertemplate":"Richness (\u043a\u043e\u043b-\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432)=%{x}\u003cbr\u003eAverage price=%{y}\u003cbr\u003eavg of F=%{z}\u003cextra\u003e\u003c\u002fextra\u003e","name":"","x":{"dtype":"i2","bdata":"AQAEAAwAKQAuABQARwABAAIAAgANAAgABgAFAFwABgAGAAEAKwAGAAMADwAQAC4AHQAOAAEANgAEAAQAAgABAAsANgABAA0AowABAAQAAQACABsADAABAA=="},"xaxis":"x","xbingroup":"x","y":{"dtype":"f8","bdata":"H4XrUbg+TEBI4XoUrh9HQFVVVVVV9UBAidqVqF2JPkCGLGQhC9k9QAAAAAAAQD1AcyDRCpuDPEAAAAAAAAA6QAAAAAAAgDlAexSuR+F6OUCKKkK8XXU5QAAAAAAAYDlAAAAAAAAAOUAzMzMzMzM3QEigaKvBwzZA16NwPQoXNkAAAAAAAAA2QAAAAAAAADZAsJza7pc2MUCBThvotAEwQHsUrkfh+i1AsEfhehQuLUBI4XoUrn8sQJjO0BVxvitAvjCeQKX8KkD42QXEplIpQHsUrkfh+idAOZmkWrtGJkA+CtejcH0lQAAAAAAAACRAexSuR+H6I0BmZmZmZuYjQJxIxolknCNAt6KRgG9eI0BI4XoUrsciQPB21b1DIiJA5q5gt4vwIEAAAAAAAAAgQAAAAAAAABxA9ihcj8L1G0A0MzMzMzMbQMCaeFY0EhtAO22g0wY6EUDsUbgehesHQA=="},"yaxis":"y","ybingroup":"y","z":{"dtype":"f8","bdata":"A1caB+jwUj8DVxoH6PByP4SCpwpcaYw\u002fe78ZSalEqD8U3TWKTTqrP8Ps4AgirZc\u002fhzjhZ0EDtT8DVxoH6PBSPwNXGgfo8GI\u002fA1caB+jwYj9kzYoLeceOPwNXGgfo8II\u002fhIKnClxpfD\u002fD7OAIIq13PxTdNYpNOrs\u002fhIKnClxpfD+EgqcKXGl8PwNXGgfo8FI\u002f7GSLybdzqT+EgqcKXGl8P4SCpwpcaWw\u002fkrGohtnBkT8DVxoH6PCSPxTdNYpNOqs\u002f2t5vRlIqoT8iDDcGy5KQPwNXGgfo8FI\u002f1HL8i4f2rz8DVxoH6PByPwNXGgfo8HI\u002fA1caB+jwYj8DVxoH6PBSP6Q3xAk\u002fC4o\u002f1HL8i4f2rz8DVxoH6PBSP2TNigt5x44\u002fzYoLecceyD8DVxoH6PBSPwNXGgfo8HI\u002fA1caB+jwUj8DVxoH6PBiP9Ry\u002fIuH9p8\u002fhIKnClxpjD8DVxoH6PBSPw=="},"type":"histogram2d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Richness (\u043a\u043e\u043b-\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Average price"}},"coloraxis":{"colorbar":{"title":{"text":"avg of F"}},"colorscale":[[0.0,"rgb(0,0,255)"],[1.0,"rgb(255,0,0)"]]},"legend":{"tracegroupgap":0},"title":{"text":"RFM Heatmap: \u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0431\u0440\u0435\u043d\u0434\u043e\u0432"}},                        {"responsive": true}                    ).then(function(){
                                              
                  var gd = document.getElementById('a0a898e7-ba98-4ebb-90b2-9152eb5b12b5');
                  var x = new MutationObserver(function (mutations, observer) {{
                          var display = window.getComputedStyle(gd).display;
                          if (!display || display === 'none') {{
                              console.log([gd, 'removed!']);
                              Plotly.purge(gd);
                              observer.disconnect();
                          }}
                  }});

                  // Listen for the removal of the full notebook cells
                  var notebookContainer = gd.closest('#notebook-container');
                  if (notebookContainer) {{
                      x.observe(notebookContainer, {childList: true});
                  }}

                  // Listen for the clearing of the current output cell
                  var outputEl = gd.closest('.output');
                  if (outputEl) {{
                      x.observe(outputEl, {childList: true});
                  }}

                                          })                };            </script>        </div>
                  </body>
                  </html>
              metadata: {}
              output_type: display_data
          sortingKey: yyyyj
          type: code
        - blockGroup: 6aef88834c174d839bc737a525c73fff
          content: |
            import plotly.express as px

            fig = px.scatter_3d(
                df_rfm,
                x="R", y="F", z="M",
                color="RFM",
                hover_name="brand",
                size="M",
                title="3D визуализация RFM-сегментов",
            )
            fig.update_layout(template="plotly_white")
            fig.show()
          executionCount: 34
          id: 63e74562223f4705b22130f6400a2347
          metadata:
            execution_start: 1763593672671
            execution_millis: 16
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - data:
                text/html: |-
                  <html>
                  <head><meta charset="utf-8" /></head>
                  <body>
                      <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
                          <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.2.0.min.js" integrity="sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=" crossorigin="anonymous"></script>                <div id="610a214d-baf3-4197-8ee4-7e6a4976c244" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("610a214d-baf3-4197-8ee4-7e6a4976c244")) {                    Plotly.newPlot(                        "610a214d-baf3-4197-8ee4-7e6a4976c244",                        [{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=113\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["mistura","stila","boosh","zorah","butter london"],"legendgroup":"113","marker":{"color":"#636efa","size":{"dtype":"f8","bdata":"H4XrUbg+TEBI4XoUrh9HQAAAAAAAADpAAAAAAACAOUB7FK5H4Xo5QA=="},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"113","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"AQQBAgI="},"y":{"dtype":"f8","bdata":"A1caB+jwUj8DVxoH6PByPwNXGgfo8FI\u002fA1caB+jwYj8DVxoH6PBiPw=="},"z":{"dtype":"f8","bdata":"H4XrUbg+TEBI4XoUrh9HQAAAAAAAADpAAAAAAACAOUB7FK5H4Xo5QA=="},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=223\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["dr. hauschka","pacifica","mineral fusion","glossier","fenty"],"legendgroup":"223","marker":{"color":"#EF553B","size":{"dtype":"f8","bdata":"VVVVVVX1QECKKkK8XXU5QAAAAAAAYDlAAAAAAAAAOUAzMzMzMzM3QA=="},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"223","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"DA0IBgU="},"y":{"dtype":"f8","bdata":"hIKnClxpjD9kzYoLeceOPwNXGgfo8II\u002fhIKnClxpfD\u002fD7OAIIq13Pw=="},"z":{"dtype":"f8","bdata":"VVVVVVX1QECKKkK8XXU5QAAAAAAAYDlAAAAAAAAAOUAzMzMzMzM3QA=="},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=333\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["benefit","smashbox","cargo cosmetics","dior","clinique"],"legendgroup":"333","marker":{"color":"#00cc96","size":{"dtype":"f8","bdata":"idqVqF2JPkCGLGQhC9k9QAAAAAAAQD1AcyDRCpuDPEBIoGirwcM2QA=="},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"333","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"KS4UR1w="},"y":{"dtype":"f8","bdata":"e78ZSalEqD8U3TWKTTqrP8Ps4AgirZc\u002fhzjhZ0EDtT8U3TWKTTq7Pw=="},"z":{"dtype":"f8","bdata":"idqVqF2JPkCGLGQhC9k9QAAAAAAAQD1AcyDRCpuDPEBIoGirwcM2QA=="},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=222\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["sante","anna sui","suncoat"],"legendgroup":"222","marker":{"color":"#ab63fa","size":{"dtype":"f8","bdata":"16NwPQoXNkAAAAAAAAA2QIFOG+i0ATBA"},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"222","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"BgYG"},"y":{"dtype":"f8","bdata":"hIKnClxpfD+EgqcKXGl8P4SCpwpcaXw\u002f"},"z":{"dtype":"f8","bdata":"16NwPQoXNkAAAAAAAAA2QIFOG+i0ATBA"},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=112\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["dalish","moov","piggy paint","orly"],"legendgroup":"112","marker":{"color":"#FFA15A","size":{"dtype":"f8","bdata":"AAAAAAAANkB7FK5H4fotQHsUrkfh+idAPgrXo3B9JUA="},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"112","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"AQMBBA=="},"y":{"dtype":"f8","bdata":"A1caB+jwUj+EgqcKXGlsPwNXGgfo8FI\u002fA1caB+jwcj8="},"z":{"dtype":"f8","bdata":"AAAAAAAANkB7FK5H4fotQHsUrkfh+idAPgrXo3B9JUA="},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=332\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["physicians formula","marcelle","pure anada","l'oreal","revlon","almay","maybelline"],"legendgroup":"332","marker":{"color":"#19d3f3","size":{"dtype":"f8","bdata":"sJza7pc2MUCwR+F6FC4tQEjhehSufyxAmM7QFXG+K0C+MJ5ApfwqQPjZBcSmUilAOZmkWrtGJkA="},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"332","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"Kw8QLh0ONg=="},"y":{"dtype":"f8","bdata":"7GSLybdzqT+SsaiG2cGRPwNXGgfo8JI\u002fFN01ik06qz\u002fa3m9GUiqhPyIMNwbLkpA\u002f1HL8i4f2rz8="},"z":{"dtype":"f8","bdata":"sJza7pc2MUCwR+F6FC4tQEjhehSufyxAmM7QFXG+K0C+MJ5ApfwqQPjZBcSmUilAOZmkWrtGJkA="},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=111\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["essie","burt's bees","alva","misa","china glaze","colourpop","salon perfect","deciem","sinful colours"],"legendgroup":"111","marker":{"color":"#FF6692","size":{"dtype":"f8","bdata":"AAAAAAAAJEB7FK5H4fojQGZmZmZm5iNASOF6FK7HIkAAAAAAAAAgQAAAAAAAABxA9ihcj8L1G0A0MzMzMzMbQOxRuB6F6wdA"},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"111","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"BAIBAQEEAQIB"},"y":{"dtype":"f8","bdata":"A1caB+jwcj8DVxoH6PBiPwNXGgfo8FI\u002fA1caB+jwUj8DVxoH6PBSPwNXGgfo8HI\u002fA1caB+jwUj8DVxoH6PBiPwNXGgfo8FI\u002f"},"z":{"dtype":"f8","bdata":"AAAAAAAAJEB7FK5H4fojQGZmZmZm5iNASOF6FK7HIkAAAAAAAAAgQAAAAAAAABxA9ihcj8L1G0A0MzMzMzMbQOxRuB6F6wdA"},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=221\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["annabelle","milani","wet n wild"],"legendgroup":"221","marker":{"color":"#B6E880","size":{"dtype":"f8","bdata":"nEjGiWScI0DwdtW9QyIiQDttoNMGOhFA"},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"221","scene":"scene","showlegend":true,"x":{"dtype":"i1","bdata":"Cw0M"},"y":{"dtype":"f8","bdata":"pDfECT8Lij9kzYoLeceOP4SCpwpcaYw\u002f"},"z":{"dtype":"f8","bdata":"nEjGiWScI0DwdtW9QyIiQDttoNMGOhFA"},"type":"scatter3d"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eRFM=331\u003cbr\u003eR=%{x}\u003cbr\u003eF=%{y}\u003cbr\u003eM=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["covergirl","nyx","e.l.f."],"legendgroup":"331","marker":{"color":"#FF97FF","size":{"dtype":"f8","bdata":"t6KRgG9eI0DmrmC3i\u002fAgQMCaeFY0EhtA"},"sizemode":"area","sizeref":0.14122500000000002,"symbol":"circle"},"mode":"markers","name":"331","scene":"scene","showlegend":true,"x":{"dtype":"i2","bdata":"NgCjABsA"},"y":{"dtype":"f8","bdata":"1HL8i4f2rz\u002fNigt5xx7IP9Ry\u002fIuH9p8\u002f"},"z":{"dtype":"f8","bdata":"t6KRgG9eI0DmrmC3i\u002fAgQMCaeFY0EhtA"},"type":"scatter3d"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"scene":{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"xaxis":{"title":{"text":"R"}},"yaxis":{"title":{"text":"F"}},"zaxis":{"title":{"text":"M"}}},"legend":{"title":{"text":"RFM"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"3D \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f RFM-\u0441\u0435\u0433\u043c\u0435\u043d\u0442\u043e\u0432"}},                        {"responsive": true}                    ).then(function(){
                                              
                  var gd = document.getElementById('610a214d-baf3-4197-8ee4-7e6a4976c244');
                  var x = new MutationObserver(function (mutations, observer) {{
                          var display = window.getComputedStyle(gd).display;
                          if (!display || display === 'none') {{
                              console.log([gd, 'removed!']);
                              Plotly.purge(gd);
                              observer.disconnect();
                          }}
                  }});

                  // Listen for the removal of the full notebook cells
                  var notebookContainer = gd.closest('#notebook-container');
                  if (notebookContainer) {{
                      x.observe(notebookContainer, {childList: true});
                  }}

                  // Listen for the clearing of the current output cell
                  var outputEl = gd.closest('.output');
                  if (outputEl) {{
                      x.observe(outputEl, {childList: true});
                  }}

                                          })                };            </script>        </div>
                  </body>
                  </html>
              metadata: {}
              output_type: display_data
          sortingKey: yyyyr
          type: code
        - blockGroup: 28c0099fc35f41b8a23e1be0f57eaf40
          content: |
            query_cohort = """
            WITH cohorts AS (
                SELECT
                    brand,
                    COUNT(*) AS items_count,
                    AVG(price) AS avg_price,
                    STDDEV(price) AS price_std,
                    COUNT(*) * 1.0 / (SELECT COUNT(*) FROM raw_data) AS share
                FROM raw_data
                GROUP BY brand
            )
            SELECT *
            FROM cohorts
            ORDER BY items_count DESC;
            """

            df_cohort = con.execute(query_cohort).df()
            df_cohort.head()
          executionCount: 37
          id: 2fc96c2575314e27b37832d6cf119383
          metadata:
            execution_start: 1763593769091
            execution_millis: 0
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 37
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 5
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: nyx
                            count: 1
                          - name: clinique
                            count: 1
                          - name: 3 others
                            count: 3
                    - name: items_count
                      dtype: int64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "54"
                        max: "163"
                        histogram:
                          - bin_start: 54
                            bin_end: 64.9
                            count: 2
                          - bin_start: 64.9
                            bin_end: 75.8
                            count: 1
                          - bin_start: 75.8
                            bin_end: 86.7
                            count: 0
                          - bin_start: 86.7
                            bin_end: 97.6
                            count: 1
                          - bin_start: 97.6
                            bin_end: 108.5
                            count: 0
                          - bin_start: 108.5
                            bin_end: 119.4
                            count: 0
                          - bin_start: 119.4
                            bin_end: 130.3
                            count: 0
                          - bin_start: 130.3
                            bin_end: 141.2
                            count: 0
                          - bin_start: 141.2
                            bin_end: 152.10000000000002
                            count: 0
                          - bin_start: 152.10000000000002
                            bin_end: 163
                            count: 1
                        categories: null
                    - name: avg_price
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "8.469815950920246"
                        max: "28.514084507042252"
                        histogram:
                          - bin_start: 8.469815950920246
                            bin_end: 10.474242806532446
                            count: 2
                          - bin_start: 10.474242806532446
                            bin_end: 12.478669662144647
                            count: 1
                          - bin_start: 12.478669662144647
                            bin_end: 14.483096517756849
                            count: 0
                          - bin_start: 14.483096517756849
                            bin_end: 16.48752337336905
                            count: 0
                          - bin_start: 16.48752337336905
                            bin_end: 18.49195022898125
                            count: 0
                          - bin_start: 18.49195022898125
                            bin_end: 20.49637708459345
                            count: 0
                          - bin_start: 20.49637708459345
                            bin_end: 22.50080394020565
                            count: 0
                          - bin_start: 22.50080394020565
                            bin_end: 24.50523079581785
                            count: 1
                          - bin_start: 24.50523079581785
                            bin_end: 26.509657651430054
                            count: 0
                          - bin_start: 26.509657651430054
                            bin_end: 28.514084507042252
                            count: 1
                        categories: null
                    - name: price_std
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "2.6087961994113096"
                        max: "10.25704351408823"
                        histogram:
                          - bin_start: 2.6087961994113096
                            bin_end: 3.3736209308790013
                            count: 3
                          - bin_start: 3.3736209308790013
                            bin_end: 4.138445662346694
                            count: 0
                          - bin_start: 4.138445662346694
                            bin_end: 4.903270393814386
                            count: 0
                          - bin_start: 4.903270393814386
                            bin_end: 5.668095125282077
                            count: 0
                          - bin_start: 5.668095125282077
                            bin_end: 6.432919856749769
                            count: 0
                          - bin_start: 6.432919856749769
                            bin_end: 7.1977445882174615
                            count: 1
                          - bin_start: 7.1977445882174615
                            bin_end: 7.962569319685153
                            count: 0
                          - bin_start: 7.962569319685153
                            bin_end: 8.727394051152846
                            count: 0
                          - bin_start: 8.727394051152846
                            bin_end: 9.492218782620537
                            count: 0
                          - bin_start: 9.492218782620537
                            bin_end: 10.25704351408823
                            count: 1
                        categories: null
                    - name: share
                      dtype: float64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "0.06242774566473988"
                        max: "0.1884393063583815"
                        histogram:
                          - bin_start: 0.06242774566473988
                            bin_end: 0.07502890173410404
                            count: 2
                          - bin_start: 0.07502890173410404
                            bin_end: 0.0876300578034682
                            count: 1
                          - bin_start: 0.0876300578034682
                            bin_end: 0.10023121387283236
                            count: 0
                          - bin_start: 0.10023121387283236
                            bin_end: 0.11283236994219653
                            count: 1
                          - bin_start: 0.11283236994219653
                            bin_end: 0.1254335260115607
                            count: 0
                          - bin_start: 0.1254335260115607
                            bin_end: 0.13803468208092484
                            count: 0
                          - bin_start: 0.13803468208092484
                            bin_end: 0.15063583815028903
                            count: 0
                          - bin_start: 0.15063583815028903
                            bin_end: 0.16323699421965315
                            count: 0
                          - bin_start: 0.16323699421965315
                            bin_end: 0.17583815028901734
                            count: 0
                          - bin_start: 0.17583815028901734
                            bin_end: 0.1884393063583815
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: nyx
                      items_count: 163
                      avg_price: 8.469815950920246
                      price_std: 2.772462352635476
                      share: 0.1884393063583815
                      _deepnote_index_column: 0
                    - brand: clinique
                      items_count: 92
                      avg_price: 22.76467391304348
                      price_std: 6.524070133075674
                      share: 0.10635838150289018
                      _deepnote_index_column: 1
                    - brand: dior
                      items_count: 71
                      avg_price: 28.514084507042252
                      price_std: 10.25704351408823
                      share: 0.08208092485549133
                      _deepnote_index_column: 2
                    - brand: maybelline
                      items_count: 54
                      avg_price: 11.138148148148149
                      price_std: 3.290107570687411
                      share: 0.06242774566473988
                      _deepnote_index_column: 3
                    - brand: covergirl
                      items_count: 54
                      avg_price: 9.68444444444445
                      price_std: 2.6087961994113096
                      share: 0.06242774566473988
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                          brand  items_count  avg_price  price_std     share
                  0         nyx          163   8.469816   2.772462  0.188439
                  1    clinique           92  22.764674   6.524070  0.106358
                  2        dior           71  28.514085  10.257044  0.082081
                  3  maybelline           54  11.138148   3.290108  0.062428
                  4   covergirl           54   9.684444   2.608796  0.062428
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>items_count</th>
                        <th>avg_price</th>
                        <th>price_std</th>
                        <th>share</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>nyx</td>
                        <td>163</td>
                        <td>8.469816</td>
                        <td>2.772462</td>
                        <td>0.188439</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>clinique</td>
                        <td>92</td>
                        <td>22.764674</td>
                        <td>6.524070</td>
                        <td>0.106358</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>dior</td>
                        <td>71</td>
                        <td>28.514085</td>
                        <td>10.257044</td>
                        <td>0.082081</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>maybelline</td>
                        <td>54</td>
                        <td>11.138148</td>
                        <td>3.290108</td>
                        <td>0.062428</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>covergirl</td>
                        <td>54</td>
                        <td>9.684444</td>
                        <td>2.608796</td>
                        <td>0.062428</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyyyv
          type: code
        - blockGroup: 284f13387aad45c3afa7691f2486cfc4
          content: >
            import pandas as pd


            df_cohort["cohort"] = pd.qcut(df_cohort["items_count"], 3,
            labels=["Cohort A", "Cohort B", "Cohort C"])

            df_cohort.head()
          executionCount: 40
          id: 41253f5c2aa7410ca14512d4a9601039
          metadata:
            execution_start: 1763593777185
            execution_millis: 9
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - output_type: execute_result
              execution_count: 40
              data:
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 6
                  columns:
                    - name: brand
                      dtype: object
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: nyx
                            count: 1
                          - name: clinique
                            count: 1
                          - name: 3 others
                            count: 3
                    - name: items_count
                      dtype: int64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "54"
                        max: "163"
                        histogram:
                          - bin_start: 54
                            bin_end: 64.9
                            count: 2
                          - bin_start: 64.9
                            bin_end: 75.8
                            count: 1
                          - bin_start: 75.8
                            bin_end: 86.7
                            count: 0
                          - bin_start: 86.7
                            bin_end: 97.6
                            count: 1
                          - bin_start: 97.6
                            bin_end: 108.5
                            count: 0
                          - bin_start: 108.5
                            bin_end: 119.4
                            count: 0
                          - bin_start: 119.4
                            bin_end: 130.3
                            count: 0
                          - bin_start: 130.3
                            bin_end: 141.2
                            count: 0
                          - bin_start: 141.2
                            bin_end: 152.10000000000002
                            count: 0
                          - bin_start: 152.10000000000002
                            bin_end: 163
                            count: 1
                        categories: null
                    - name: avg_price
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "8.469815950920246"
                        max: "28.514084507042252"
                        histogram:
                          - bin_start: 8.469815950920246
                            bin_end: 10.474242806532446
                            count: 2
                          - bin_start: 10.474242806532446
                            bin_end: 12.478669662144647
                            count: 1
                          - bin_start: 12.478669662144647
                            bin_end: 14.483096517756849
                            count: 0
                          - bin_start: 14.483096517756849
                            bin_end: 16.48752337336905
                            count: 0
                          - bin_start: 16.48752337336905
                            bin_end: 18.49195022898125
                            count: 0
                          - bin_start: 18.49195022898125
                            bin_end: 20.49637708459345
                            count: 0
                          - bin_start: 20.49637708459345
                            bin_end: 22.50080394020565
                            count: 0
                          - bin_start: 22.50080394020565
                            bin_end: 24.50523079581785
                            count: 1
                          - bin_start: 24.50523079581785
                            bin_end: 26.509657651430054
                            count: 0
                          - bin_start: 26.509657651430054
                            bin_end: 28.514084507042252
                            count: 1
                        categories: null
                    - name: price_std
                      dtype: float64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: "2.6087961994113096"
                        max: "10.25704351408823"
                        histogram:
                          - bin_start: 2.6087961994113096
                            bin_end: 3.3736209308790013
                            count: 3
                          - bin_start: 3.3736209308790013
                            bin_end: 4.138445662346694
                            count: 0
                          - bin_start: 4.138445662346694
                            bin_end: 4.903270393814386
                            count: 0
                          - bin_start: 4.903270393814386
                            bin_end: 5.668095125282077
                            count: 0
                          - bin_start: 5.668095125282077
                            bin_end: 6.432919856749769
                            count: 0
                          - bin_start: 6.432919856749769
                            bin_end: 7.1977445882174615
                            count: 1
                          - bin_start: 7.1977445882174615
                            bin_end: 7.962569319685153
                            count: 0
                          - bin_start: 7.962569319685153
                            bin_end: 8.727394051152846
                            count: 0
                          - bin_start: 8.727394051152846
                            bin_end: 9.492218782620537
                            count: 0
                          - bin_start: 9.492218782620537
                            bin_end: 10.25704351408823
                            count: 1
                        categories: null
                    - name: share
                      dtype: float64
                      stats:
                        unique_count: 4
                        nan_count: 0
                        min: "0.06242774566473988"
                        max: "0.1884393063583815"
                        histogram:
                          - bin_start: 0.06242774566473988
                            bin_end: 0.07502890173410404
                            count: 2
                          - bin_start: 0.07502890173410404
                            bin_end: 0.0876300578034682
                            count: 1
                          - bin_start: 0.0876300578034682
                            bin_end: 0.10023121387283236
                            count: 0
                          - bin_start: 0.10023121387283236
                            bin_end: 0.11283236994219653
                            count: 1
                          - bin_start: 0.11283236994219653
                            bin_end: 0.1254335260115607
                            count: 0
                          - bin_start: 0.1254335260115607
                            bin_end: 0.13803468208092484
                            count: 0
                          - bin_start: 0.13803468208092484
                            bin_end: 0.15063583815028903
                            count: 0
                          - bin_start: 0.15063583815028903
                            bin_end: 0.16323699421965315
                            count: 0
                          - bin_start: 0.16323699421965315
                            bin_end: 0.17583815028901734
                            count: 0
                          - bin_start: 0.17583815028901734
                            bin_end: 0.1884393063583815
                            count: 1
                        categories: null
                    - name: cohort
                      dtype: category
                      stats:
                        unique_count: 1
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Cohort C
                            count: 5
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - brand: nyx
                      items_count: 163
                      avg_price: 8.469815950920246
                      price_std: 2.772462352635476
                      share: 0.1884393063583815
                      cohort: Cohort C
                      _deepnote_index_column: 0
                    - brand: clinique
                      items_count: 92
                      avg_price: 22.76467391304348
                      price_std: 6.524070133075674
                      share: 0.10635838150289018
                      cohort: Cohort C
                      _deepnote_index_column: 1
                    - brand: dior
                      items_count: 71
                      avg_price: 28.514084507042252
                      price_std: 10.25704351408823
                      share: 0.08208092485549133
                      cohort: Cohort C
                      _deepnote_index_column: 2
                    - brand: maybelline
                      items_count: 54
                      avg_price: 11.138148148148149
                      price_std: 3.290107570687411
                      share: 0.06242774566473988
                      cohort: Cohort C
                      _deepnote_index_column: 3
                    - brand: covergirl
                      items_count: 54
                      avg_price: 9.68444444444445
                      price_std: 2.6087961994113096
                      share: 0.06242774566473988
                      cohort: Cohort C
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                          brand  items_count  avg_price  price_std     share    cohort
                  0         nyx          163   8.469816   2.772462  0.188439  Cohort C
                  1    clinique           92  22.764674   6.524070  0.106358  Cohort C
                  2        dior           71  28.514085  10.257044  0.082081  Cohort C
                  3  maybelline           54  11.138148   3.290108  0.062428  Cohort C
                  4   covergirl           54   9.684444   2.608796  0.062428  Cohort C
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>brand</th>
                        <th>items_count</th>
                        <th>avg_price</th>
                        <th>price_std</th>
                        <th>share</th>
                        <th>cohort</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>nyx</td>
                        <td>163</td>
                        <td>8.469816</td>
                        <td>2.772462</td>
                        <td>0.188439</td>
                        <td>Cohort C</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>clinique</td>
                        <td>92</td>
                        <td>22.764674</td>
                        <td>6.524070</td>
                        <td>0.106358</td>
                        <td>Cohort C</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>dior</td>
                        <td>71</td>
                        <td>28.514085</td>
                        <td>10.257044</td>
                        <td>0.082081</td>
                        <td>Cohort C</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>maybelline</td>
                        <td>54</td>
                        <td>11.138148</td>
                        <td>3.290108</td>
                        <td>0.062428</td>
                        <td>Cohort C</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>covergirl</td>
                        <td>54</td>
                        <td>9.684444</td>
                        <td>2.608796</td>
                        <td>0.062428</td>
                        <td>Cohort C</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
              metadata:
                table_state_spec: null
          sortingKey: yyyyx
          type: code
        - blockGroup: a9d081a40cf447408b4acf7a3df50884
          content: |-
            Где:
            Cohort A — бренды с большим количеством позиций
            Cohort B — средние
            Cohort C — маленькие бренды
          id: 776af5846a0b4fb3b64c842ba3305f8e
          metadata:
            formattedRanges: []
          sortingKey: yyyyy
          type: text-cell-p
        - blockGroup: 69170bc6eff449148e238714826ae0da
          content: |
            import plotly.express as px

            fig = px.scatter(
                df_cohort,
                x="items_count",
                y="avg_price",
                color="cohort",
                size="share",
                hover_name="brand",
                title="Когортный анализ брендов по размеру ассортимента",
                labels={
                    "items_count": "Количество товаров",
                    "avg_price": "Средняя цена",
                    "share": "Доля бренда в каталоге"
                }
            )
            fig.update_layout(template="plotly_white")
            fig.show()
          executionCount: 43
          id: faef0723a8814469891f41a776bdfac3
          metadata:
            execution_start: 1763593793131
            execution_millis: 101
            execution_context_id: de90cc03-624e-409a-a8de-764887ef77b8
          outputs:
            - data:
                text/html: |-
                  <html>
                  <head><meta charset="utf-8" /></head>
                  <body>
                      <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
                          <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.2.0.min.js" integrity="sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=" crossorigin="anonymous"></script>                <div id="64b1fddf-8270-426b-afd8-a31383a10d34" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("64b1fddf-8270-426b-afd8-a31383a10d34")) {                    Plotly.newPlot(                        "64b1fddf-8270-426b-afd8-a31383a10d34",                        [{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003ecohort=Cohort C\u003cbr\u003e\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432=%{x}\u003cbr\u003e\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430=%{y}\u003cbr\u003e\u0414\u043e\u043b\u044f \u0431\u0440\u0435\u043d\u0434\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["nyx","clinique","dior","maybelline","covergirl","l'oreal","smashbox","physicians formula","benefit","revlon","e.l.f.","cargo cosmetics","pure anada","marcelle","almay"],"legendgroup":"Cohort C","marker":{"color":"#636efa","size":{"dtype":"f8","bdata":"zYoLecceyD8U3TWKTTq7P4c44WdBA7U\u002f1HL8i4f2rz\u002fUcvyLh\u002favPxTdNYpNOqs\u002fFN01ik06qz\u002fsZIvJt3OpP3u\u002fGUmpRKg\u002f2t5vRlIqoT\u002fUcvyLh\u002fafP8Ps4AgirZc\u002fA1caB+jwkj+SsaiG2cGRPyIMNwbLkpA\u002f"},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"Cohort C","orientation":"v","showlegend":true,"x":{"dtype":"i2","bdata":"owBcAEcANgA2AC4ALgArACkAHQAbABQAEAAPAA4A"},"xaxis":"x","y":{"dtype":"f8","bdata":"5q5gt4vwIEBIoGirwcM2QHMg0QqbgzxAOZmkWrtGJkC3opGAb14jQJjO0BVxvitAhixkIQvZPUCwnNrulzYxQInalahdiT5AvjCeQKX8KkDAmnhWNBIbQAAAAAAAQD1ASOF6FK5\u002fLECwR+F6FC4tQPjZBcSmUilA"},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003ecohort=Cohort B\u003cbr\u003e\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432=%{x}\u003cbr\u003e\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430=%{y}\u003cbr\u003e\u0414\u043e\u043b\u044f \u0431\u0440\u0435\u043d\u0434\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["milani","pacifica","wet n wild","dr. hauschka","annabelle","mineral fusion","anna sui","sante","glossier","suncoat","fenty"],"legendgroup":"Cohort B","marker":{"color":"#EF553B","size":{"dtype":"f8","bdata":"ZM2KC3nHjj9kzYoLeceOP4SCpwpcaYw\u002fhIKnClxpjD+kN8QJPwuKPwNXGgfo8II\u002fhIKnClxpfD+EgqcKXGl8P4SCpwpcaXw\u002fhIKnClxpfD\u002fD7OAIIq13Pw=="},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"Cohort B","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"DQ0MDAsIBgYGBgU="},"xaxis":"x","y":{"dtype":"f8","bdata":"8HbVvUMiIkCKKkK8XXU5QDttoNMGOhFAVVVVVVX1QECcSMaJZJwjQAAAAAAAYDlAAAAAAAAANkDXo3A9Chc2QAAAAAAAADlAgU4b6LQBMEAzMzMzMzM3QA=="},"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003ecohort=Cohort A\u003cbr\u003e\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432=%{x}\u003cbr\u003e\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430=%{y}\u003cbr\u003e\u0414\u043e\u043b\u044f \u0431\u0440\u0435\u043d\u0434\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["essie","orly","stila","colourpop","moov","zorah","deciem","butter london","burt's bees","dalish","sinful colours","china glaze","misa","alva","boosh","mistura","salon perfect","piggy paint"],"legendgroup":"Cohort A","marker":{"color":"#00cc96","size":{"dtype":"f8","bdata":"A1caB+jwcj8DVxoH6PByPwNXGgfo8HI\u002fA1caB+jwcj+EgqcKXGlsPwNXGgfo8GI\u002fA1caB+jwYj8DVxoH6PBiPwNXGgfo8GI\u002fA1caB+jwUj8DVxoH6PBSPwNXGgfo8FI\u002fA1caB+jwUj8DVxoH6PBSPwNXGgfo8FI\u002fA1caB+jwUj8DVxoH6PBSPwNXGgfo8FI\u002f"},"sizemode":"area","sizeref":0.00047109826589595373,"symbol":"circle"},"mode":"markers","name":"Cohort A","orientation":"v","showlegend":true,"x":{"dtype":"i1","bdata":"BAQEBAMCAgICAQEBAQEBAQEB"},"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAAJEA+CtejcH0lQEjhehSuH0dAAAAAAAAAHEB7FK5H4fotQAAAAAAAgDlANDMzMzMzG0B7FK5H4Xo5QHsUrkfh+iNAAAAAAAAANkDsUbgehesHQAAAAAAAACBASOF6FK7HIkBmZmZmZuYjQAAAAAAAADpAH4XrUbg+TED2KFyPwvUbQHsUrkfh+idA"},"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0446\u0435\u043d\u0430"}},"legend":{"title":{"text":"cohort"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"\u041a\u043e\u0433\u043e\u0440\u0442\u043d\u044b\u0439 \u0430\u043d\u0430\u043b\u0438\u0437 \u0431\u0440\u0435\u043d\u0434\u043e\u0432 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0443 \u0430\u0441\u0441\u043e\u0440\u0442\u0438\u043c\u0435\u043d\u0442\u0430"}},                        {"responsive": true}                    ).then(function(){
                                              
                  var gd = document.getElementById('64b1fddf-8270-426b-afd8-a31383a10d34');
                  var x = new MutationObserver(function (mutations, observer) {{
                          var display = window.getComputedStyle(gd).display;
                          if (!display || display === 'none') {{
                              console.log([gd, 'removed!']);
                              Plotly.purge(gd);
                              observer.disconnect();
                          }}
                  }});

                  // Listen for the removal of the full notebook cells
                  var notebookContainer = gd.closest('#notebook-container');
                  if (notebookContainer) {{
                      x.observe(notebookContainer, {childList: true});
                  }}

                  // Listen for the clearing of the current output cell
                  var outputEl = gd.closest('.output');
                  if (outputEl) {{
                      x.observe(outputEl, {childList: true});
                  }}

                                          })                };            </script>        </div>
                  </body>
                  </html>
              metadata: {}
              output_type: display_data
          sortingKey: yyyyyU
          type: code
      executionMode: block
      id: 8bd7ecef2a68464496b2d68a96921f61
      isModule: false
      name: ABC, XYZ, RFM, когорты
  settings: {}
version: 1.0.0
