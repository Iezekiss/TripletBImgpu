
# # –õ+–ü ‚Ññ4. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞

## –í–∞—Ä–∏–∞–Ω—Ç 11 ‚Äî –ê–Ω–∞–ª–∏–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ –∞–≤–∏–∞—Ä–µ–π—Å–æ–≤ (Kaggle ‚Üí Airflow ‚Üí PostgreSQL ‚Üí Superset)

## üéØ **–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã**

–ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–∫–≤–æ–∑–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω–≤–µ–π–µ—Ä –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –∞–≤–∏–∞—Ä–µ–π—Å–æ–≤ –≤ –°–®–ê.
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:

1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å Kaggle
2. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
3. –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –≤–∏—Ç—Ä–∏–Ω—ã
4. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞ –≤ Apache Superset

---

# üß© **–û–ø–∏—Å–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–∫–µ–π—Å–∞**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç:
üì¶ **US DOT ‚Äî Flight Delays**
[https://www.kaggle.com/datasets/usdot/flight-delays](https://www.kaggle.com/datasets/usdot/flight-delays)

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–µ–π—Å–æ–≤, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –∑–∞–¥–µ—Ä–∂–µ–∫ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏.

---

# üìä **–¢—Ä–µ–±—É–µ–º—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ —É—Å–ª–æ–≤–∏—é –≤–∞—Ä–∏–∞–Ω—Ç–∞)**

1. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä:** –æ–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–∞–Ω–Ω—ã—Ö —Ä–µ–π—Å–æ–≤
2. **–°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞:** –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º
3. **–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞:** –¥–æ–ª—è —Ä–µ–π—Å–æ–≤ –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º
4. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞:**

   * —Å—Ç–æ–ª–±—Ü—ã ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–π—Å–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º
   * –ª–∏–Ω–∏—è ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–∞–Ω–Ω—ã—Ö —Ä–µ–π—Å–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º
5. **–õ–∏–Ω–µ–π–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞:** —Å—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ (arrival_delay_minutes) –ø–æ –º–µ—Å—è—Ü–∞–º

---


## –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –û–±—â–∞—è —Å—Ö–µ–º–∞ —Å–∏—Å—Ç–µ–º—ã

![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](./img/arch.jpg)


### ETL-–ø—Ä–æ—Ü–µ—Å—Å

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Kaggle    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Airflow   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ PostgreSQL ‚îÇ‚îÄ‚îÄ‚ñ∂‚îÇ  Superset   ‚îÇ
‚îÇ   Dataset   ‚îÇ    ‚îÇ   Extract   ‚îÇ    ‚îÇ   Load      ‚îÇ    ‚îÇ Visualize   ‚îÇ
‚îÇ             ‚îÇ    ‚îÇ   Transform ‚îÇ    ‚îÇ   Transform ‚îÇ    ‚îÇ             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

![–°—Ö–µ–º–∞ –∫–æ–Ω–≤–µ–µ—Ä–∞ ETL](./img/conveer.jpg)

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Airflow –∫ PostgreSQL

**–°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: `postgresql://airflow:airflow@postgres:5432/airflow`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**:
- **Host**: postgres
- **Port**: 5432
- **Database**: airflow
- **Username**: airflow
- **Password**: airflow

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ analytics_postgres

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ analytics_postgres**

| –ü–æ–ª–µ –≤ Airflow | –ó–Ω–∞—á–µ–Ω–∏–µ | –û—Ç–∫—É–¥–∞ –≤–∑—è—Ç–æ (–∏–∑ docker-compose.yml) |
|---|---|---|
| Connection Id | analytics_postgres | –ò–º—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –≤ DAG |
| Connection Type | Postgres | –¢–∏–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| Host | analytics_postgres | –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ –≤ Docker Compose |
| Schema | analytics | –ò–∑ environment: POSTGRES_DB=analytics |
| Login | analytics | –ò–∑ environment: POSTGRES_USER=analytics |
| Password | analytics | –ò–∑ environment: POSTGRES_PASSWORD=analytics |
| Port | 5432 | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |

**–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**:
1. –ó–∞–π–¥–∏—Ç–µ –≤ Airflow UI: http://localhost:8080
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Admin -> Connections
3. –ù–∞–∂–º–∏—Ç–µ —Å–∏–Ω—é—é –∫–Ω–æ–ø–∫—É + ("Add a new record")
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É Test (–¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è "Connection successfully tested")
6. –ù–∞–∂–º–∏—Ç–µ Save

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

*   **Apache Airflow 2.5.0** ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
*   **PostgreSQL 12** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∏—Ç—Ä–∏–Ω–∞
*   **Apache Superset 3.1.1** ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
*   **Kaggle API** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Kaggle
*   **pgAdmin 4** ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL
*   **Redis 7** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–µ—Å—Å–∏–∏ –¥–ª—è Superset
*   **Docker & Docker Compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

### Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

*   **pandas** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
*   **kaggle** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å Kaggle API
*   **kagglehub** ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
*   **psycopg2-binary** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
*   **apache-airflow-providers-postgres** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Airflow —Å PostgreSQL

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

*   **–ö–∞—Å—Ç–æ–º–Ω—ã–π Dockerfile** ‚Äî –æ–±—Ä–∞–∑ Airflow —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º gcc –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤
*   **Docker Volumes** ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
*   **Docker Networks** ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤

---

# üì¶ **ETL-–∫–æ–Ω–≤–µ–π–µ—Ä**

## 1) Extract (Kaggle ‚Üí –ª–æ–∫–∞–ª—å–Ω—ã–π data/)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è KaggleHub –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è `flights.csv`.

–§–∞–π–ª –∫–ª–∞–¥—ë—Ç—Å—è –≤ `/opt/airflow/dags/data/flights.csv`.

---

## 2) Load (CSV ‚Üí raw_flights_11)

–ó–∞–≥—Ä—É–∑–∫–∞ **200 000 —Å—Ç—Ä–æ–∫** —á–µ—Ä–µ–∑ COPY –≤ —Ç–∞–±–ª–∏—Ü—É:

```
raw_flights_11
```

–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ –∏—Å—Ö–æ–¥–Ω—ã–π CSV Kaggle.

---

## 3) Transform (—Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω—ã dm_flights_11)

`datamart_variant_11.sql`:

```sql
CREATE OR REPLACE VIEW dm_flights_11 AS
SELECT
    MONTH AS month,
    AIRLINE AS airline,
    ORIGIN AS origin_airport,
    CASE WHEN ARRIVAL_DELAY > 0 THEN 1 ELSE 0 END AS is_delayed,
    ARRIVAL_DELAY AS arrival_delay_minutes
FROM raw_flights_11;
```

–≠—Ç–æ "—É–∑–∫–∞—è" –≤–∏—Ç—Ä–∏–Ω–∞ ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ–ª—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.

---

# üß¨ **DAG (variant_11_flight_delays)**

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç—Ä–∏ –∑–∞–¥–∞—á–∏: Extract ‚Üí Load ‚Üí Transform:

```python
dag = DAG(
    dag_id="variant_11_flight_delays",
    schedule_interval=None,
    ...
)
```

### extract_from_kaggle

–°–∫–∞—á–∏–≤–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç `usdot/flight-delays`.

### load_raw_to_postgres

–°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É `raw_flights_11` –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 200 000 —Å—Ç—Ä–æ–∫.

### create_datamart

–í—ã–ø–æ–ª–Ω—è–µ—Ç SQL —Ñ–∞–π–ª–∞ `sql/datamart_variant_11.sql`.

---

# üóÉ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü**

## raw_flights_11 (—Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ)

> 31 –∫–æ–ª–æ–Ω–∫–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Kaggle
> –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:

* YEAR
* MONTH
* AIRLINE
* ORIGIN / DESTINATION
* ARRIVAL_DELAY
* CANCELLED / DIVERTED
* SYSTEM / WEATHER / SECURITY delays

## dm_flights_11 (–≤–∏—Ç—Ä–∏–Ω–∞)

| –ü–æ–ª–µ                  | –û–ø–∏—Å–∞–Ω–∏–µ                    |
| --------------------- | --------------------------- |
| month                 | –º–µ—Å—è—Ü (1‚Äì12)                |
| airline               | –∫–æ–¥ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏–∏            |
| origin_airport        | –∞—ç—Ä–æ–ø–æ—Ä—Ç –≤—ã–ª–µ—Ç–∞             |
| is_delayed            | –±–∏–Ω–∞—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–µ—Ä–∂–∫–∏ |
| arrival_delay_minutes | –≤–µ–ª–∏—á–∏–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∏           |

---

# üì° **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ Airflow**

**Connection ID:** `analytics_postgres`

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ           |
| ---- | ------------------ |
| Host | analytics_postgres |
| DB   | analytics          |
| User | analytics          |
| Pass | analytics          |
| Port | 5432               |

---

# üìä **–†–∞–±–æ—Ç–∞ –≤ Superset**

## 1) –°–æ–∑–¥–∞–Ω–∏–µ Dataset

Database: **analytics**
Table/View: **dm_flights_11**

---

# üìà **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π**

## 1. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä ‚Äî % –∑–∞–¥–µ—Ä–∂–µ–∫

Chart: **Big Number**
Metric:

```sql
AVG(is_delayed)
```

Format ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç.

---

## 2. % –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º (Bar Chart)

X-Axis: `airline`
Metric:

```sql
AVG(is_delayed)
```

Sort: DESC

---

## 3. –î–æ–ª—è —Ä–µ–π—Å–æ–≤ –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º (Pie Chart)

Dimension: `airline`
Metric: `COUNT(*)`

---

## 4. Mixed Chart: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–π—Å–æ–≤ + % –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –º–µ—Å—è—Ü–∞–º

Query A (Bar):

* X: `month`
* Metric: COUNT(*)

Query B (Line):

* X: `month`
* Metric: AVG(is_delayed)

**–í–∞–∂–Ω–æ:** –≤ Customize
Disable time-series mode ‚Üí X-Axis type = categorical.

---

## 5. Line Chart: —Å—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º

Chart: **Line**
X-Axis: `month`
Metric: `AVG(arrival_delay_minutes)`

---

# üìä **–ò—Ç–æ–≥–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥**

–í–∫–ª—é—á–∞–µ—Ç:

‚úî –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä
‚úî –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
‚úî –°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
‚úî Mixed Chart
‚úî –õ–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
‚úî –§–∏–ª—å—Ç—Ä –ø–æ airline, origin (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

# üßº **–û—á–∏—Å—Ç–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

```bash
docker compose down -v
```

---

# üóÇ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```
lpw_04/
‚îÇ
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îú‚îÄ‚îÄ dag_variant_11.py
‚îÇ   ‚îú‚îÄ‚îÄ sql/datamart_variant_11.sql
‚îÇ   ‚îî‚îÄ‚îÄ data/flights.csv
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ setup_kaggle.sh
‚îú‚îÄ‚îÄ cleanup.sh
‚îî‚îÄ‚îÄ README.md
```

---

# üìù **–í—ã–≤–æ–¥—ã –ø–æ —Ä–∞–±–æ—Ç–µ**

1. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞–±–æ—á–∏–π ETL-–∫–æ–Ω–≤–µ–π–µ—Ä –Ω–∞ Airflow.
2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –≤–∏—Ç—Ä–∏–Ω–∞ dm_flights_11 —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–æ–ª—è–º–∏.
3. –°–æ–∑–¥–∞–Ω –¥–∞—à–±–æ—Ä–¥, –æ—Ç—Ä–∞–∂–∞—é—â–∏–π –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ –∞–≤–∏–∞—Ä–µ–π—Å–æ–≤.
4. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π –º–µ—Å—è—Ü–∞ Superset —Ä–µ—à–µ–Ω—ã (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –æ—Å–∏).
5. –ü–æ–ª—É—á–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

   * –Ω–∞–≥—Ä—É–∑–∫—É –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º
   * –¥–æ–ª—é –∑–∞–¥–µ—Ä–∂–µ–∫
   * —Å—Ä–µ–¥–Ω—é—é –≤–µ–ª–∏—á–∏–Ω—É –∑–∞–¥–µ—Ä–∂–∫–∏
   * —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å



